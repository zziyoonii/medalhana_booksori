{"ast":null,"code":"// 더미 데이터 - 경기도 도서관 (시립 중앙도서관 + 동네 작은도서관)\nexport const dummyLibraries = [\n// 수원시 도서관들\n{\n  id: '1',\n  name: '경기도립중앙도서관',\n  address: '경기 수원시 영통구 월드컵로 235',\n  phone: '031-249-4800',\n  hours: '09:00-18:00',\n  website: 'https://www.library.kr/',\n  distance: 0.8,\n  coordinates: {\n    lat: 37.299,\n    lng: 127.070\n  },\n  type: '공공도서관'\n}, {\n  id: '2',\n  name: '수원시립중앙도서관',\n  address: '경기 수원시 영통구 광교로 183',\n  phone: '031-228-4300',\n  hours: '09:00-22:00',\n  website: 'https://www.suwonlib.go.kr/',\n  distance: 1.2,\n  coordinates: {\n    lat: 37.295,\n    lng: 127.075\n  },\n  type: '공공도서관'\n}, {\n  id: '3',\n  name: '영통구립도서관',\n  address: '경기 수원시 영통구 영통동 999-1',\n  phone: '031-228-4350',\n  hours: '09:00-20:00',\n  website: 'https://www.suwonlib.go.kr/',\n  distance: 1.5,\n  coordinates: {\n    lat: 37.293,\n    lng: 127.073\n  },\n  type: '구립도서관'\n}, {\n  id: '4',\n  name: '광교작은도서관',\n  address: '경기 수원시 영통구 광교동 1275',\n  phone: '031-228-4380',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 1.8,\n  coordinates: {\n    lat: 37.291,\n    lng: 127.077\n  },\n  type: '작은도서관'\n}, {\n  id: '5',\n  name: '망포작은도서관',\n  address: '경기 수원시 영통구 망포동 578-2',\n  phone: '031-228-4390',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 2.1,\n  coordinates: {\n    lat: 37.285,\n    lng: 127.065\n  },\n  type: '작은도서관'\n},\n// 성남시 도서관들\n{\n  id: '6',\n  name: '성남시립중앙도서관',\n  address: '경기 성남시 분당구 양현로 346',\n  phone: '031-729-4600',\n  hours: '09:00-18:00',\n  website: 'https://www.snlib.go.kr/',\n  distance: 2.5,\n  coordinates: {\n    lat: 37.350,\n    lng: 127.105\n  },\n  type: '공공도서관'\n}, {\n  id: '7',\n  name: '분당구립정자도서관',\n  address: '경기 성남시 분당구 정자동 178-1',\n  phone: '031-729-4650',\n  hours: '09:00-20:00',\n  website: 'https://www.snlib.go.kr/',\n  distance: 2.8,\n  coordinates: {\n    lat: 37.365,\n    lng: 127.110\n  },\n  type: '구립도서관'\n}, {\n  id: '8',\n  name: '서현작은도서관',\n  address: '경기 성남시 분당구 서현동 271-3',\n  phone: '031-729-4670',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 3.1,\n  coordinates: {\n    lat: 37.348,\n    lng: 127.123\n  },\n  type: '작은도서관'\n}, {\n  id: '9',\n  name: '야탑작은도서관',\n  address: '경기 성남시 분당구 야탑동 344-10',\n  phone: '031-729-4680',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 3.3,\n  coordinates: {\n    lat: 37.341,\n    lng: 127.128\n  },\n  type: '작은도서관'\n},\n// 고양시 도서관들\n{\n  id: '10',\n  name: '고양시립중앙도서관',\n  address: '경기 고양시 덕양구 고양대로 1955',\n  phone: '031-8075-9300',\n  hours: '09:00-18:00',\n  website: 'https://www.goyanglib.go.kr/',\n  distance: 4.2,\n  coordinates: {\n    lat: 37.650,\n    lng: 126.830\n  },\n  type: '공공도서관'\n}, {\n  id: '11',\n  name: '일산동구립도서관',\n  address: '경기 고양시 일산동구 백석동 1256',\n  phone: '031-8075-9350',\n  hours: '09:00-20:00',\n  website: 'https://www.goyanglib.go.kr/',\n  distance: 4.5,\n  coordinates: {\n    lat: 37.670,\n    lng: 126.775\n  },\n  type: '구립도서관'\n}, {\n  id: '12',\n  name: '백석작은도서관',\n  address: '경기 고양시 일산동구 백석동 1234-5',\n  phone: '031-8075-9380',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 4.8,\n  coordinates: {\n    lat: 37.675,\n    lng: 126.780\n  },\n  type: '작은도서관'\n}, {\n  id: '13',\n  name: '마두작은도서관',\n  address: '경기 고양시 일산동구 마두동 775-2',\n  phone: '031-8075-9390',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 5.1,\n  coordinates: {\n    lat: 37.655,\n    lng: 126.785\n  },\n  type: '작은도서관'\n},\n// 부천시 도서관들\n{\n  id: '14',\n  name: '부천시립중앙도서관',\n  address: '경기 부천시 원미구 길주로 1',\n  phone: '032-625-4700',\n  hours: '09:00-18:00',\n  website: 'https://www.bclib.go.kr/',\n  distance: 3.1,\n  coordinates: {\n    lat: 37.490,\n    lng: 126.783\n  },\n  type: '공공도서관'\n}, {\n  id: '15',\n  name: '원미구립도서관',\n  address: '경기 부천시 원미구 중동 1033-3',\n  phone: '032-625-4750',\n  hours: '09:00-20:00',\n  website: 'https://www.bclib.go.kr/',\n  distance: 3.4,\n  coordinates: {\n    lat: 37.485,\n    lng: 126.788\n  },\n  type: '구립도서관'\n}, {\n  id: '16',\n  name: '중동작은도서관',\n  address: '경기 부천시 원미구 중동 1178-1',\n  phone: '032-625-4780',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 3.7,\n  coordinates: {\n    lat: 37.488,\n    lng: 126.791\n  },\n  type: '작은도서관'\n}, {\n  id: '17',\n  name: '역곡작은도서관',\n  address: '경기 부천시 원미구 역곡동 201-8',\n  phone: '032-625-4790',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 4.0,\n  coordinates: {\n    lat: 37.486,\n    lng: 126.794\n  },\n  type: '작은도서관'\n},\n// 안양시 도서관들\n{\n  id: '18',\n  name: '안양시립중앙도서관',\n  address: '경기 안양시 만안구 문예로 30',\n  phone: '031-389-0800',\n  hours: '09:00-22:00',\n  website: 'https://www.aylib.go.kr/',\n  distance: 3.8,\n  coordinates: {\n    lat: 37.400,\n    lng: 126.950\n  },\n  type: '공공도서관'\n}, {\n  id: '19',\n  name: '만안구립도서관',\n  address: '경기 안양시 만안구 안양동 678-49',\n  phone: '031-389-0850',\n  hours: '09:00-20:00',\n  website: 'https://www.aylib.go.kr/',\n  distance: 4.1,\n  coordinates: {\n    lat: 37.395,\n    lng: 126.955\n  },\n  type: '구립도서관'\n}, {\n  id: '20',\n  name: '안양동작은도서관',\n  address: '경기 안양시 만안구 안양동 123-45',\n  phone: '031-389-0880',\n  hours: '10:00-18:00',\n  website: '',\n  distance: 4.4,\n  coordinates: {\n    lat: 37.398,\n    lng: 126.958\n  },\n  type: '작은도서관'\n},\n// 용인시 도서관들\n{\n  id: '21',\n  name: '용인시립중앙도서관',\n  address: '경기 용인시 처인구 중부대로 1199',\n  phone: '031-324-4800',\n  hours: '09:00-18:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 4.8,\n  coordinates: {\n    lat: 37.230,\n    lng: 127.208\n  },\n  type: '공공도서관'\n}, {\n  id: '22',\n  name: '수지구립도서관',\n  address: '경기 용인시 수지구 수지동 1234-1',\n  phone: '031-324-4850',\n  hours: '09:00-20:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 5.1,\n  coordinates: {\n    lat: 37.325,\n    lng: 127.095\n  },\n  type: '구립도서관'\n}, {\n  id: '23',\n  name: '기흥구립도서관',\n  address: '경기 용인시 기흥구 구갈동 567-8',\n  phone: '031-324-4880',\n  hours: '09:00-20:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 5.4,\n  coordinates: {\n    lat: 37.275,\n    lng: 127.115\n  },\n  type: '구립도서관'\n}, {\n  id: '23-1',\n  name: '처인도서관',\n  address: '경기 용인시 처인구 금령로 33번길 15',\n  phone: '031-324-4670',\n  hours: '09:00-18:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 5.6,\n  coordinates: {\n    lat: 37.236,\n    lng: 127.200\n  },\n  type: '공공도서관'\n}, {\n  id: '23-2',\n  name: '서농도서관',\n  address: '경기 용인시 기흥구 서천서로 83',\n  phone: '031-324-4680',\n  hours: '09:00-18:00',\n  website: '',\n  distance: 5.8,\n  coordinates: {\n    lat: 37.241,\n    lng: 127.077\n  },\n  type: '공공도서관'\n}, {\n  id: '23-3',\n  name: '포곡도서관',\n  address: '경기 용인시 처인구 포곡읍 에버랜드로 860',\n  phone: '031-324-4690',\n  hours: '09:00-18:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 6.0,\n  coordinates: {\n    lat: 37.294,\n    lng: 127.202\n  },\n  type: '공공도서관'\n}, {\n  id: '23-4',\n  name: '흥덕도서관',\n  address: '경기 용인시 기흥구 흥덕중앙로 120',\n  phone: '031-324-4700',\n  hours: '09:00-18:00',\n  website: 'https://www.yonginlib.go.kr/',\n  distance: 5.2,\n  coordinates: {\n    lat: 37.238,\n    lng: 127.119\n  },\n  type: '공공도서관'\n},\n// 화성시 도서관들\n{\n  id: '24',\n  name: '화성시립중앙도서관',\n  address: '경기 화성시 남양읍 시청로 155',\n  phone: '031-369-6800',\n  hours: '09:00-18:00',\n  website: 'https://www.hscitylib.go.kr/',\n  distance: 6.2,\n  coordinates: {\n    lat: 37.200,\n    lng: 126.831\n  },\n  type: '공공도서관'\n}, {\n  id: '25',\n  name: '동탄구립도서관',\n  address: '경기 화성시 동탄면 동탄대로 300',\n  phone: '031-369-6850',\n  hours: '09:00-20:00',\n  website: 'https://www.hscitylib.go.kr/',\n  distance: 6.5,\n  coordinates: {\n    lat: 37.205,\n    lng: 127.078\n  },\n  type: '구립도서관'\n}];\n\n// 더미 도서 데이터\nexport const dummyBooks = [{\n  id: 1,\n  title: '82년생 김지영',\n  author: '조남주',\n  publisher: '민음사',\n  isbn: '9788937473722',\n  category: '소설',\n  publishYear: '2016',\n  description: '한국 여성의 현실을 담은 화제의 소설',\n  imageUrl: ''\n}, {\n  id: 2,\n  title: '미드나잇 라이브러리',\n  author: '매트 헤이그',\n  publisher: '인플루엔셜',\n  isbn: '9791197377109',\n  category: '소설',\n  publishYear: '2020',\n  description: '후회와 선택에 관한 철학적 소설',\n  imageUrl: ''\n}, {\n  id: 3,\n  title: '사피엔스',\n  author: '유발 하라리',\n  publisher: '김영사',\n  isbn: '9788934972464',\n  category: '인문',\n  publishYear: '2015',\n  description: '인류의 역사를 다룬 베스트셀러',\n  imageUrl: ''\n}, {\n  id: 4,\n  title: '아몬드',\n  author: '손원평',\n  publisher: '창비',\n  isbn: '9788936434267',\n  category: '소설',\n  publishYear: '2017',\n  description: '감정을 느끼지 못하는 소년의 성장 소설',\n  imageUrl: ''\n}, {\n  id: 5,\n  title: '정의란 무엇인가',\n  author: '마이클 샌델',\n  publisher: '김영사',\n  isbn: '9788934942467',\n  category: '철학',\n  publishYear: '2010',\n  description: '정의에 대한 철학적 탐구',\n  imageUrl: ''\n}];\n\n// 더미 독서모임 데이터\nexport const dummyReadingGroups = [{\n  id: 1,\n  name: '시니어 독서 클럽',\n  description: '50-60대를 위한 독서 모임입니다.',\n  libraryId: '1',\n  libraryName: '경기도립중앙도서관',\n  meetingDate: '2024-01-15',\n  meetingTime: '14:00',\n  maxMembers: 15,\n  currentMembers: 8,\n  bookTitle: '82년생 김지영',\n  bookAuthor: '조남주',\n  category: '소설',\n  difficulty: '쉬움',\n  meetingType: 'library',\n  organizer: '김도서',\n  contact: '010-1234-5678',\n  status: 'active'\n}, {\n  id: 2,\n  name: '역사 탐구 모임',\n  description: '한국사와 세계사를 함께 읽는 모임',\n  libraryId: '2',\n  libraryName: '수원시립중앙도서관',\n  meetingDate: '2024-01-20',\n  meetingTime: '10:00',\n  maxMembers: 12,\n  currentMembers: 6,\n  bookTitle: '사피엔스',\n  bookAuthor: '유발 하라리',\n  category: '인문',\n  difficulty: '보통',\n  meetingType: 'library',\n  organizer: '박역사',\n  contact: '010-2345-6789',\n  status: 'active'\n}];\n/**\n * 경기도 공공데이터 API 서비스 클래스\n * 실제 구현 시 아래 API들을 활용할 수 있습니다:\n * \n * 1. 경기데이터드림 (data.gg.go.kr)\n *    - 경기도 도서관 정보 API\n *    - 도서관 시설 현황 API\n *    - 문화시설 통합 정보 API\n * \n * 2. 도서관정보나루 (data4library.kr) \n *    - 전국 도서관 표준 API\n *    - 도서 검색 API\n *    - 대출/예약 현황 API\n * \n * 3. 서울열린데이터광장 등 시군별 Open API\n *    - 각 시군별 도서관 API\n *    - 지역별 문화시설 API\n */\nexport class LibraryAPIService {\n  constructor(config) {\n    this.config = void 0;\n    this.config = config;\n  }\n\n  /**\n   * 경기도 도서관 목록 조회\n   * 실제 API: https://openapi.gg.go.kr/TBGGIBLLBR\n   */\n  async getLibraries(location, radius) {\n    try {\n      // 경기데이터드림 도서관 현황 API 호출 (올바른 엔드포인트)\n      const apiUrl = `https://openapi.gg.go.kr/TBGGIBLLBR`;\n      const params = new URLSearchParams({\n        KEY: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d',\n        Type: 'json',\n        pIndex: '1',\n        pSize: '500' // 검색 범위 확대\n      });\n      const response = await fetch(`${apiUrl}?${params}`);\n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status}`);\n      }\n      const data = await response.json();\n\n      // 경기데이터드림 API 응답 구조에 맞게 데이터 변환\n      let libraries = [];\n      if (data.TBGGIBLLBR && data.TBGGIBLLBR[1] && data.TBGGIBLLBR[1].row) {\n        libraries = data.TBGGIBLLBR[1].row.map((item, index) => ({\n          id: (index + 1).toString(),\n          name: item.LBRRY_NM || '도서관명 없음',\n          address: item.REFINE_ROADNM_ADDR || item.REFINE_LOTNO_ADDR || '주소 없음',\n          phone: item.TELNO || '전화번호 없음',\n          hours: item.OPER_TIME || '09:00-18:00',\n          // 실제 운영시간 사용\n          website: item.HMPG_ADDR || '',\n          distance: Math.round(Math.random() * 5 * 10) / 10,\n          // 임시 거리 계산\n          coordinates: {\n            lat: parseFloat(item.REFINE_WGS84_LAT) || 37.5,\n            lng: parseFloat(item.REFINE_WGS84_LOGT) || 127.0\n          },\n          type: '공공도서관'\n        }));\n      }\n\n      // 용인시 도서관들 수동 추가 (API에서 검색되지 않는 경우 대비)\n      const additionalLibraries = [{\n        id: 'yongin_central',\n        name: '용인시립중앙도서관',\n        address: '경기도 용인시 처인구 중부대로 1199',\n        phone: '031-324-4600',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 1.2,\n        coordinates: {\n          lat: 37.231,\n          lng: 127.208\n        },\n        type: '공공도서관'\n      }, {\n        id: 'giheung_lib',\n        name: '기흥도서관',\n        address: '경기도 용인시 기흥구 기흥로 19',\n        phone: '031-324-4660',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 1.8,\n        coordinates: {\n          lat: 37.275,\n          lng: 127.115\n        },\n        type: '공공도서관'\n      }, {\n        id: 'suji_lib',\n        name: '수지도서관',\n        address: '경기도 용인시 수지구 포은대로 435',\n        phone: '031-324-4650',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 2.1,\n        coordinates: {\n          lat: 37.324,\n          lng: 127.094\n        },\n        type: '공공도서관'\n      }, {\n        id: 'cheoin_lib',\n        name: '처인도서관',\n        address: '경기도 용인시 처인구 금령로 33번길 15',\n        phone: '031-324-4670',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 2.3,\n        coordinates: {\n          lat: 37.236,\n          lng: 127.200\n        },\n        type: '공공도서관'\n      }, {\n        id: 'seongnam_lib',\n        name: '서농도서관',\n        address: '경기도 용인시 기흥구 서천서로 83',\n        phone: '031-324-4680',\n        hours: '09:00-18:00',\n        website: '',\n        distance: 2.5,\n        coordinates: {\n          lat: 37.241,\n          lng: 127.077\n        },\n        type: '공공도서관'\n      }, {\n        id: 'pogok_lib',\n        name: '포곡도서관',\n        address: '경기도 용인시 처인구 포곡읍 에버랜드로 860',\n        phone: '031-324-4690',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 3.2,\n        coordinates: {\n          lat: 37.294,\n          lng: 127.202\n        },\n        type: '공공도서관'\n      }, {\n        id: 'heungdeok_lib',\n        name: '흥덕도서관',\n        address: '경기도 용인시 기흥구 흥덕중앙로 120',\n        phone: '031-324-4700',\n        hours: '09:00-18:00',\n        website: 'https://www.yonginlib.go.kr',\n        distance: 2.8,\n        coordinates: {\n          lat: 37.238,\n          lng: 127.119\n        },\n        type: '공공도서관'\n      }];\n      return [...libraries, ...additionalLibraries];\n    } catch (error) {\n      console.error('도서관 정보 조회 실패:', error);\n      console.log('더미 데이터로 대체합니다.');\n      return dummyLibraries; // 오류 시 더미 데이터 반환\n    }\n  }\n\n  /**\n   * 도서 검색 - 도서관정보나루 API 활용\n   * 실제 API: http://data4library.kr/api/srchBooks\n   */\n  async searchBooks(params) {\n    try {\n      var _data$response, _data$response2;\n      const apiUrl = 'http://data4library.kr/api/srchBooks';\n\n      // 검색어 전처리 및 인코딩\n      const cleanQuery = params.query.trim().replace(/\\s+/g, ' ');\n      const searchParams = new URLSearchParams({\n        authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n        title: cleanQuery,\n        pageNo: (params.pageNo || 1).toString(),\n        pageSize: (params.pageSize || 10).toString(),\n        format: 'json'\n      });\n      console.log('🔍 도서 검색 API 호출:', `${apiUrl}?${searchParams}`);\n      console.log('🔍 검색어:', cleanQuery);\n      const response = await fetch(`${apiUrl}?${searchParams}`);\n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      console.log('📊 도서검색 API 전체 응답:', JSON.stringify(data, null, 2));\n\n      // API 응답 구조 분석\n      console.log('🔍 도서검색 API 응답 구조 분석:');\n      console.log('- data.response:', data.response);\n      console.log('- data.response.docs:', (_data$response = data.response) === null || _data$response === void 0 ? void 0 : _data$response.docs);\n      console.log('- data.response.numFound:', (_data$response2 = data.response) === null || _data$response2 === void 0 ? void 0 : _data$response2.numFound);\n\n      // 결과가 없는 경우 다른 방식으로 재시도\n      if (data.response && data.response.numFound === 0) {\n        console.log('⚠️ 첫 번째 검색에서 결과 없음, 다른 방식으로 재시도');\n\n        // 작가명으로 검색해보기\n        const authorSearchParams = new URLSearchParams({\n          authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n          author: cleanQuery,\n          pageNo: (params.pageNo || 1).toString(),\n          pageSize: (params.pageSize || 10).toString(),\n          format: 'json'\n        });\n        console.log('🔍 작가명으로 재검색:', `${apiUrl}?${authorSearchParams}`);\n        const authorResponse = await fetch(`${apiUrl}?${authorSearchParams}`);\n        if (authorResponse.ok) {\n          const authorData = await authorResponse.json();\n          console.log('📊 작가명 검색 결과:', JSON.stringify(authorData, null, 2));\n          if (authorData.response && authorData.response.numFound > 0) {\n            data.response = authorData.response;\n          }\n        }\n      }\n\n      // API 응답 구조 확인 및 데이터 추출\n      let rawBooks = [];\n      if (data.response && data.response.docs && data.response.docs.length > 0) {\n        // 각 docs 요소에서 doc 객체 추출\n        rawBooks = data.response.docs.map(item => {\n          // item이 직접 도서 데이터인지 확인\n          if (item.bookname || item.title) {\n            return item;\n          }\n          // 또는 item.doc 형태인지 확인\n          if (item.doc) {\n            return item.doc;\n          }\n          return item;\n        }).filter(doc => doc && (doc.bookname || doc.title));\n      } else if (data.response && data.response.book) {\n        rawBooks = Array.isArray(data.response.book) ? data.response.book : [data.response.book];\n      } else if (data.response && data.response.result) {\n        rawBooks = data.response.result.docs || data.response.result;\n      }\n      console.log('📚 원본 도서 데이터:', rawBooks);\n      if (rawBooks && rawBooks.length > 0) {\n        const books = rawBooks.filter(book => {\n          console.log('📖 개별 도서 데이터 확인:', book);\n          const hasTitle = book.bookname || book.title;\n          return hasTitle && hasTitle.trim() !== '';\n        }).map((book, index) => ({\n          id: book.isbn13 || book.isbn || `book_${index}`,\n          title: (book.bookname || book.title || '').trim(),\n          author: book.authors || book.author || '작가 미상',\n          publisher: book.publisher || '출판사 미상',\n          isbn: book.isbn13 || book.isbn || '',\n          category: book.class_nm || book.category || '일반',\n          publishYear: book.publication_year || book.publishYear || '2023',\n          description: book.description || '',\n          imageUrl: book.bookImageURL || book.imageUrl || '',\n          loanCount: parseInt(book.loan_count || book.loanCount || '0') || 0\n        }));\n        console.log('✅ 변환된 도서 데이터:', books);\n        console.log(`🎯 제목이 있는 도서 ${books.length}권을 찾았습니다.`);\n        return books;\n      }\n\n      // API 응답이 예상과 다른 경우 검색어 기반 더미 데이터 생성\n      console.warn('⚠️ API 응답 구조가 예상과 다름, 검색어 기반 더미 데이터 생성');\n      return this.getDummyBooksForQuery(params.query);\n    } catch (error) {\n      console.error('💥 도서 검색 실패:', error);\n      console.log('🔄 검색어 기반 더미 데이터로 대체합니다.');\n      return this.getDummyBooksForQuery(params.query);\n    }\n  }\n\n  /**\n   * 검색어 기반 더미 데이터 생성\n   */\n  getDummyBooksForQuery(query) {\n    const searchTerm = query.trim();\n\n    // 검색어에 따른 맞춤 더미 데이터\n    const dummyBooks = [{\n      id: `dummy_${Date.now()}`,\n      title: searchTerm,\n      author: '작가 미상',\n      publisher: '출판사 정보 없음',\n      isbn: '9788000000000',\n      category: '일반',\n      publishYear: '2023',\n      description: `\"${searchTerm}\"에 대한 검색 결과입니다. 정확한 도서 정보는 직접 도서관에 문의해 주세요.`,\n      imageUrl: '',\n      loanCount: 0\n    }];\n    console.log(`🎯 검색어 \"${searchTerm}\" 기반 더미 데이터 생성:`, dummyBooks);\n    return dummyBooks;\n  }\n\n  /**\n   * 도서 소장 현황 조회 - 도서관정보나루 API 활용\n   * 실제 API: http://data4library.kr/api/libSrchByBook\n   */\n  async getBookAvailability(isbn, region = '41') {\n    try {\n      const apiUrl = 'http://data4library.kr/api/libSrchByBook';\n\n      // 지역코드 매핑 (경기도: 41, 서울: 11, 부산: 26, 대구: 27, 인천: 28, 광주: 29, 대전: 30, 울산: 31, 세종: 36, 강원: 42, 충북: 43, 충남: 44, 전북: 45, 전남: 46, 경북: 47, 경남: 48, 제주: 50)\n      const regionCodes = {\n        '서울': '11',\n        '부산': '26',\n        '대구': '27',\n        '인천': '28',\n        '광주': '29',\n        '대전': '30',\n        '울산': '31',\n        '세종': '36',\n        '경기': '41',\n        '경기도': '41',\n        '강원': '42',\n        '충북': '43',\n        '충남': '44',\n        '전북': '45',\n        '전남': '46',\n        '경북': '47',\n        '경남': '48',\n        '제주': '50'\n      };\n\n      // 지역명을 코드로 변환\n      const regionCode = regionCodes[region] || region || '41'; // 기본값: 경기도\n\n      const params = new URLSearchParams({\n        authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n        isbn: isbn,\n        region: regionCode,\n        format: 'json'\n      });\n      console.log('📚 도서 소장 현황 API 호출:', `${apiUrl}?${params}`);\n      console.log('🗺️ 지역:', region, '→ 지역코드:', regionCode);\n      const response = await fetch(`${apiUrl}?${params}`);\n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      console.log('📊 소장 현황 API 전체 응답:', JSON.stringify(data, null, 2));\n\n      // 에러 응답 체크\n      if (data.response && data.response.error) {\n        console.error('❌ API 에러:', data.response.error);\n\n        // 지역코드 에러인 경우 다른 지역으로 재시도\n        if (data.response.error.includes('지역코드')) {\n          console.log('⚠️ 지역코드 에러, 전국 검색으로 재시도');\n\n          // 전국 검색 (지역코드 없이)\n          const nationalParams = new URLSearchParams({\n            authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n            isbn: isbn,\n            format: 'json'\n          });\n          const nationalResponse = await fetch(`${apiUrl}?${nationalParams}`);\n          if (nationalResponse.ok) {\n            const nationalData = await nationalResponse.json();\n            console.log('🌍 전국 검색 결과:', JSON.stringify(nationalData, null, 2));\n            if (nationalData.response && nationalData.response.libs) {\n              data.response = nationalData.response;\n            }\n          }\n        }\n      }\n      if (data.response && data.response.libs && data.response.libs.length > 0) {\n        const availability = data.response.libs.map(lib => {\n          var _lib$lib, _lib$lib2, _lib$book, _lib$book2, _lib$book3, _lib$book4;\n          return {\n            libraryId: ((_lib$lib = lib.lib) === null || _lib$lib === void 0 ? void 0 : _lib$lib.libCode) || lib.libCode || '',\n            libraryName: ((_lib$lib2 = lib.lib) === null || _lib$lib2 === void 0 ? void 0 : _lib$lib2.libName) || lib.libName || '도서관명 없음',\n            available: ((_lib$book = lib.book) === null || _lib$book === void 0 ? void 0 : _lib$book.loanAvailable) === 'Y' || lib.loanAvailable === 'Y',\n            loanable: ((_lib$book2 = lib.book) === null || _lib$book2 === void 0 ? void 0 : _lib$book2.loanAvailable) === 'Y' || lib.loanAvailable === 'Y',\n            reservable: ((_lib$book3 = lib.book) === null || _lib$book3 === void 0 ? void 0 : _lib$book3.reserveAvailable) === 'Y' || lib.reserveAvailable === 'Y',\n            dueDate: ((_lib$book4 = lib.book) === null || _lib$book4 === void 0 ? void 0 : _lib$book4.returnPlanDate) || lib.returnPlanDate || undefined\n          };\n        });\n        console.log('✅ 소장 현황 조회 성공:', availability);\n        return availability;\n      }\n      console.log('⚠️ 소장 정보 없음 또는 구조 다름');\n      return [];\n    } catch (error) {\n      console.error('💥 도서 소장 현황 조회 실패:', error);\n\n      // 에러 발생 시 빈 배열 반환 (더미 데이터는 제거)\n      return [];\n    }\n  }\n\n  /**\n   * 도서 예약\n   * 실제 API: 각 도서관별 대출/예약 시스템 API\n   */\n  async reserveBook(bookId, libraryId, userId) {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/books/reserve`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ bookId, libraryId, userId, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n\n      // 현재는 더미 응답 반환\n      console.log(`도서 예약 요청: 도서 ${bookId}, 도서관 ${libraryId}, 사용자 ${userId}`);\n      return true;\n    } catch (error) {\n      console.error('도서 예약 실패:', error);\n      return false;\n    }\n  }\n\n  /**\n   * 독서 모임 조회\n   * 실제 API: 각 도서관별 프로그램 API 또는 커뮤니티 API\n   */\n  async getReadingGroups(libraryId) {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups?libraryId=${libraryId}&apiKey=${this.config.apiKey}`);\n      // const data = await response.json();\n      // return data.result;\n\n      // 현재는 더미 데이터 반환\n      if (libraryId) {\n        return dummyReadingGroups.filter(group => group.libraryId === libraryId);\n      }\n      return dummyReadingGroups;\n    } catch (error) {\n      console.error('독서 모임 조회 실패:', error);\n      return [];\n    }\n  }\n\n  /**\n   * 독서 모임 가입\n   */\n  async joinReadingGroup(groupId, userId) {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups/${groupId}/join`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ userId, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n\n      // 현재는 더미 응답 반환\n      console.log(`독서 모임 가입 요청: 모임 ${groupId}, 사용자 ${userId}`);\n      return true;\n    } catch (error) {\n      console.error('독서 모임 가입 실패:', error);\n      return false;\n    }\n  }\n\n  /**\n   * 독서 모임 생성\n   */\n  async createReadingGroup(groupData) {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ ...groupData, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n\n      // 현재는 더미 응답 반환\n      console.log('독서 모임 생성 요청:', groupData);\n      return true;\n    } catch (error) {\n      console.error('독서 모임 생성 실패:', error);\n      return false;\n    }\n  }\n}\n\n// 기본 API 설정 (환경변수에서 로드)\nexport const defaultLibraryAPI = new LibraryAPIService({\n  baseURL: process.env.REACT_APP_GYEONGGI_API_URL || 'https://openapi.gg.go.kr',\n  apiKey: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d'\n});\n\n// API 키 설정 가이드\nexport const API_SETUP_GUIDE = {\n  title: '경기도 공공데이터 API 연동 가이드',\n  steps: [{\n    step: 1,\n    title: '경기데이터드림 회원가입',\n    description: 'https://data.gg.go.kr 에서 회원가입',\n    url: 'https://data.gg.go.kr'\n  }, {\n    step: 2,\n    title: 'API 키 발급',\n    description: '도서관 정보 API 서비스 신청 및 키 발급',\n    note: '승인까지 1-2일 소요'\n  }, {\n    step: 3,\n    title: '환경변수 설정',\n    description: '.env 파일에 API 키 추가',\n    code: `REACT_APP_GYEONGGI_API_URL=https://openapi.gg.go.kr\nREACT_APP_GYEONGGI_API_KEY=your_api_key_here\nREACT_APP_LIBRARY_API_KEY=your_library_api_key_here`\n  }, {\n    step: 4,\n    title: '도서관정보나루 연동',\n    description: 'data4library.kr에서 추가 도서 정보 API 활용',\n    url: 'https://www.data4library.kr'\n  }],\n  additionalAPIs: [{\n    name: '경기데이터드림',\n    url: 'https://data.gg.go.kr',\n    description: '경기도 공공데이터 포털',\n    apis: ['도서관 시설 정보', '문화시설 현황', '공공시설 위치 정보']\n  }, {\n    name: '도서관정보나루',\n    url: 'https://www.data4library.kr',\n    description: '국가도서관통계시스템',\n    apis: ['전국 도서관 정보', '도서 검색', '대출 통계']\n  }, {\n    name: '각 시군 Open API',\n    description: '수원시, 성남시 등 각 지역별 API',\n    apis: ['지역별 도서관 API', '문화 프로그램 정보', '시설 예약 시스템']\n  }]\n};\n\n// 도서관 정보나루 API 서비스\nconst BASE_URL = 'http://data4library.kr/api';\n\n// API 인증키 (실제 인증키로 설정)\n// 도서관정보나루 API 키 설정됨\nconst AUTH_KEY = process.env.REACT_APP_LIBRARY_API_KEY || '651824a6d5a5d765b513f7f8059ef5ffb2ac3c30f15f0114a8764076c8b902b8';\n\n// API 승인 상태 확인 함수\nexport const checkApiApprovalStatus = async apiKey => {\n  try {\n    var _data$message, _data$message2;\n    const response = await fetch(`https://www.data4library.kr/api/loanItemSrch?authKey=${apiKey}&startDt=2024-01-01&endDt=2024-01-31&pageNo=1&pageSize=1&format=json`);\n    const data = await response.json();\n\n    // API 키가 승인되지 않은 경우 에러 응답을 받음\n    if (data.error || (_data$message = data.message) !== null && _data$message !== void 0 && _data$message.includes('인증키') || (_data$message2 = data.message) !== null && _data$message2 !== void 0 && _data$message2.includes('승인')) {\n      return false;\n    }\n    return true;\n  } catch (error) {\n    console.error('API 승인 상태 확인 중 오류:', error);\n    return false;\n  }\n};\n\n// 지역 코드 매핑 및 연령대 매핑 (필요 시 사용)\n\n// XML 응답을 파싱하는 함수\nconst parseXMLResponse = xmlString => {\n  try {\n    // DOMParser를 사용하여 XML 파싱\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(xmlString, 'text/xml');\n\n    // 파싱 오류 체크\n    const parseError = xmlDoc.getElementsByTagName('parsererror')[0];\n    if (parseError) {\n      console.error('XML 파싱 오류:', parseError.textContent);\n      return {\n        response: {\n          docs: []\n        }\n      };\n    }\n\n    // 인기대출도서 데이터 추출\n    const docs = xmlDoc.getElementsByTagName('doc');\n    const books = [];\n    for (let i = 0; i < docs.length; i++) {\n      const doc = docs[i];\n      const book = {};\n\n      // 각 필드 추출\n      const getTextContent = tagName => {\n        const element = doc.getElementsByTagName(tagName)[0];\n        return (element === null || element === void 0 ? void 0 : element.textContent) || '';\n      };\n      book.bookname = getTextContent('bookname');\n      book.authors = getTextContent('authors');\n      book.publisher = getTextContent('publisher');\n      book.publication_year = getTextContent('publication_year');\n      book.isbn13 = getTextContent('isbn13');\n      book.loan_count = parseInt(getTextContent('loan_count') || '0') || 0;\n      book.ranking = parseInt(getTextContent('ranking') || '0') || 0;\n      if (book.bookname && book.bookname.trim() !== '') {\n        books.push(book);\n      }\n    }\n    console.log(`📚 XML에서 추출된 도서 ${books.length}권:`, books);\n    return {\n      response: {\n        docs: books,\n        numFound: books.length,\n        start: 0\n      }\n    };\n  } catch (error) {\n    console.error('XML 파싱 중 오류 발생:', error);\n    return {\n      response: {\n        docs: []\n      }\n    };\n  }\n};\n/**\n * 인기 대출 도서 조회 API\n */\nexport const fetchPopularBooks = async (startDate, endDate) => {\n  // 기본값: 실제 데이터가 있는 최근 기간 (2025년 데이터 사용)\n  const defaultEndDate = '2025-07-13'; // 2025년 7월 13일\n  const defaultStartDate = '2025-01-01'; // 2025년 시작\n\n  const actualStartDate = startDate || defaultStartDate;\n  const actualEndDate = endDate || defaultEndDate;\n  try {\n    var _data$response3, _data$response4, _data$response4$docs, _rawBooks;\n    const params = new URLSearchParams({\n      authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n      startDt: actualStartDate,\n      endDt: actualEndDate,\n      pageNo: '1',\n      pageSize: '20'\n    });\n    const url = `http://data4library.kr/api/loanItemSrch?${params}`;\n    console.log(`🔥 인기대출도서 API 호출 (${actualStartDate} ~ ${actualEndDate}):`, url);\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`API 호출 실패: ${response.status}`);\n    }\n    const responseText = await response.text();\n    console.log('📊 인기도서 API 원본 응답:', responseText.substring(0, 500) + '...');\n    let data;\n    try {\n      // JSON 파싱 시도\n      data = JSON.parse(responseText);\n    } catch (jsonError) {\n      // XML 응답인 경우 파싱\n      console.log('⚠️ JSON 파싱 실패, XML 응답 처리 중...');\n      data = parseXMLResponse(responseText);\n    }\n    console.log('📊 인기도서 API 파싱된 데이터:', JSON.stringify(data, null, 2));\n\n    // API 에러 체크\n    if (data.response && data.response.error) {\n      console.warn('API 에러:', data.response.error);\n      if (data.response.error.includes('활성화')) {\n        console.log('💡 API 키가 아직 활성화되지 않았습니다. 더미 데이터를 사용합니다.');\n      }\n      throw new Error(data.response.error);\n    }\n    console.log('🔍 API 응답 구조 분석:');\n    console.log('- data.response:', data.response);\n    console.log('- data.response.docs:', (_data$response3 = data.response) === null || _data$response3 === void 0 ? void 0 : _data$response3.docs);\n    console.log('- docs 길이:', (_data$response4 = data.response) === null || _data$response4 === void 0 ? void 0 : (_data$response4$docs = _data$response4.docs) === null || _data$response4$docs === void 0 ? void 0 : _data$response4$docs.length);\n\n    // API 응답 데이터 구조에 맞게 변환\n    let rawBooks = [];\n    if (data.response && data.response.docs) {\n      rawBooks = data.response.docs;\n    } else if (data.response && data.response.result) {\n      rawBooks = data.response.result.docs || [];\n    } else if (Array.isArray(data.response)) {\n      rawBooks = data.response;\n    }\n    console.log('📚 원본 도서 데이터:', rawBooks);\n    const books = ((_rawBooks = rawBooks) === null || _rawBooks === void 0 ? void 0 : _rawBooks.filter(book => {\n      console.log('📖 개별 도서 데이터:', book);\n      return book.bookname && book.bookname.trim() !== '';\n    }).map((book, index) => ({\n      id: book.isbn || `book_${index}`,\n      title: book.bookname.trim(),\n      // 제목 공백 제거\n      author: book.authors || '작가 미상',\n      publisher: book.publisher || '출판사 미상',\n      isbn: book.isbn || '',\n      loanCount: parseInt(book.loan_count) || (index + 1) * 1000,\n      // 대출수가 없으면 순위 기반으로 추정\n      category: book.class_nm || '일반',\n      publishYear: book.publication_year || '2023'\n    }))) || [];\n    console.log(`🏆 인기도서 ${books.length}권 조회 완료:`, books);\n    return books;\n  } catch (error) {\n    console.error('❌ 인기도서 API 호출 오류:', error);\n\n    // API 호출 실패시 더미 데이터 반환\n    return getFallbackPopularBooks();\n  }\n};\n\n/**\n * API 호출 실패시 사용할 더미 데이터\n */\n// 성인 대상 인기 도서 Top 5 (아동 도서 제외, 최신순)\nconst getFallbackPopularBooks = () => {\n  console.log('📚 Fallback 인기도서 데이터 사용 (다양한 장르 포함)');\n  return [{\n    id: '1',\n    title: '어린왕자',\n    author: '생텍쥐페리',\n    publisher: '열린책들',\n    isbn: '9788932917245',\n    loanCount: 6890,\n    category: '문학',\n    publishYear: '2015'\n  }, {\n    id: '2',\n    title: '해리포터와 마법사의 돌',\n    author: 'J.K. 롤링',\n    publisher: '문학수첩',\n    isbn: '9788983920003',\n    loanCount: 6234,\n    category: '판타지',\n    publishYear: '2014'\n  }, {\n    id: '3',\n    title: '2030 자산관리 고민백서',\n    author: '오건영',\n    publisher: '비즈니스북스',\n    isbn: '9791162542439',\n    loanCount: 5420,\n    category: '경제',\n    publishYear: '2023'\n  }, {\n    id: '4',\n    title: '트렌드 코리아 2024',\n    author: '김난도',\n    publisher: '미래의창',\n    isbn: '9788959897264',\n    loanCount: 4890,\n    category: '사회',\n    publishYear: '2023'\n  }, {\n    id: '5',\n    title: '세이노의 가르침',\n    author: '세이노',\n    publisher: '데이원',\n    isbn: '9791191043297',\n    loanCount: 4321,\n    category: '자기계발',\n    publishYear: '2023'\n  }, {\n    id: '6',\n    title: '불편한 편의점',\n    author: '김호연',\n    publisher: '나무옆의자',\n    isbn: '9791167370778',\n    loanCount: 4156,\n    category: '소설',\n    publishYear: '2021'\n  }, {\n    id: '7',\n    title: '달러구트 꿈 백화점',\n    author: '이미예',\n    publisher: '팩토리나인',\n    isbn: '9791165340564',\n    loanCount: 3987,\n    category: '소설',\n    publishYear: '2020'\n  }, {\n    id: '8',\n    title: '82년생 김지영',\n    author: '조남주',\n    publisher: '민음사',\n    isbn: '9788937473142',\n    loanCount: 3765,\n    category: '소설',\n    publishYear: '2016'\n  }, {\n    id: '9',\n    title: '미드나잇 라이브러리',\n    author: '매트 헤이그',\n    publisher: '인플루엔셜',\n    isbn: '9788960516618',\n    loanCount: 3542,\n    category: '소설',\n    publishYear: '2021'\n  }, {\n    id: '10',\n    title: '소년이 온다',\n    author: '한강',\n    publisher: '창비',\n    isbn: '9788936434120',\n    loanCount: 3298,\n    category: '소설',\n    publishYear: '2014'\n  }];\n};\n\n/**\n * 도서 검색 API 함수 (외부에서 직접 호출용)\n */\nexport const searchBooksAPI = async (query, pageNo = 1, pageSize = 10) => {\n  const apiService = new LibraryAPIService({\n    baseURL: BASE_URL,\n    apiKey: AUTH_KEY\n  });\n  return await apiService.searchBooks({\n    query,\n    pageNo,\n    pageSize\n  });\n};\n\n/**\n * API 연결 상태 테스트\n */\nexport const testApiConnection = async () => {\n  try {\n    console.log('🔄 API 연결 테스트 시작...');\n\n    // 1. 도서관정보나루 API 테스트\n    const testQuery = '해리포터';\n    const searchUrl = `${BASE_URL}/srchBooks`;\n    const params = new URLSearchParams({\n      authKey: AUTH_KEY,\n      format: 'json',\n      pageNo: '1',\n      pageSize: '5',\n      keyword: testQuery\n    });\n    const libraryResponse = await fetch(`${searchUrl}?${params}`);\n    const libraryData = await libraryResponse.json();\n\n    // 2. 경기데이터드림 API 테스트 (여러 시도)\n    const gyeonggiApiKey = process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d';\n    let gyeonggiResponse;\n    let gyeonggiData;\n\n    // 첫 번째 시도: 올바른 엔드포인트 사용\n    try {\n      const gyeonggiUrl1 = `https://openapi.gg.go.kr/TBGGIBLLBR`;\n      const gyeonggiParams1 = new URLSearchParams({\n        KEY: gyeonggiApiKey,\n        Type: 'json',\n        pIndex: '1',\n        pSize: '10'\n      });\n      gyeonggiResponse = await fetch(`${gyeonggiUrl1}?${gyeonggiParams1}`);\n      gyeonggiData = await gyeonggiResponse.json();\n      if (!gyeonggiResponse.ok) {\n        throw new Error('First attempt failed');\n      }\n    } catch (error) {\n      // 두 번째 시도: 다른 매개변수 형식\n      try {\n        const gyeonggiUrl2 = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${gyeonggiApiKey}&Type=json&pIndex=1&pSize=10`;\n        gyeonggiResponse = await fetch(gyeonggiUrl2);\n        gyeonggiData = await gyeonggiResponse.json();\n        if (!gyeonggiResponse.ok) {\n          throw new Error('Second attempt failed');\n        }\n      } catch (error2) {\n        // 세 번째 시도: 기본 매개변수만 사용\n        try {\n          const gyeonggiUrl3 = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${gyeonggiApiKey}`;\n          gyeonggiResponse = await fetch(gyeonggiUrl3);\n          gyeonggiData = await gyeonggiResponse.json();\n          if (!gyeonggiResponse.ok) {\n            throw new Error('Third attempt failed');\n          }\n        } catch (error3) {\n          // 모든 시도 실패 시 기본값\n          gyeonggiResponse = {\n            ok: false\n          };\n          gyeonggiData = {\n            error: 'All attempts failed'\n          };\n        }\n      }\n    }\n    const libraryApiSuccess = libraryResponse.ok && libraryData.response && libraryData.response.docs;\n    const gyeonggiApiSuccess = gyeonggiResponse.ok && gyeonggiData.TBGGIBLLBR && gyeonggiData.TBGGIBLLBR[1];\n    if (libraryApiSuccess && gyeonggiApiSuccess) {\n      var _gyeonggiData$TBGGIBL;\n      console.log('✅ 도서관정보나루 API 연결 성공');\n      console.log('✅ 경기데이터드림 API 연결 성공');\n      return {\n        success: true,\n        message: '모든 API 연결 성공! 실제 도서관 데이터를 사용합니다.',\n        details: {\n          libraryBooks: libraryData.response.numFound,\n          gyeonggiLibraries: ((_gyeonggiData$TBGGIBL = gyeonggiData.TBGGIBLLBR[1].row) === null || _gyeonggiData$TBGGIBL === void 0 ? void 0 : _gyeonggiData$TBGGIBL.length) || 0,\n          sampleBooks: libraryData.response.docs.slice(0, 3)\n        }\n      };\n    } else if (libraryApiSuccess) {\n      console.log('✅ 도서관정보나루 API 연결 성공');\n      console.log('❌ 경기데이터드림 API 연결 실패');\n      return {\n        success: true,\n        message: '도서관정보나루 API만 연결됨. 도서 검색은 가능하지만 일부 기능이 제한됩니다.',\n        details: {\n          libraryBooks: libraryData.response.numFound,\n          gyeonggiLibraries: 0,\n          sampleBooks: libraryData.response.docs.slice(0, 3)\n        }\n      };\n    } else {\n      var _gyeonggiData;\n      console.log('❌ 도서관정보나루 API 연결 실패');\n      console.log('❌ 경기데이터드림 API 연결 실패');\n\n      // 각 API의 실패 원인을 자세히 분석\n      const failureAnalysis = {\n        libraryApi: {\n          status: libraryResponse.status,\n          statusText: libraryResponse.statusText,\n          data: libraryData\n        },\n        gyeonggiApi: {\n          status: gyeonggiResponse.ok ? 'ok' : 'failed',\n          data: gyeonggiData,\n          error: ((_gyeonggiData = gyeonggiData) === null || _gyeonggiData === void 0 ? void 0 : _gyeonggiData.error) || 'Unknown error'\n        }\n      };\n      return {\n        success: false,\n        message: 'API 연결 실패. 브라우저에서 CORS 제한이나 API 키 문제일 수 있습니다.',\n        details: failureAnalysis\n      };\n    }\n  } catch (error) {\n    console.error('API 연결 테스트 오류:', error);\n    return {\n      success: false,\n      message: 'API 연결 오류. 네트워크를 확인하거나 더미 데이터를 사용합니다.',\n      details: error\n    };\n  }\n};\n\n/**\n * 경기데이터드림 API CORS 우회 테스트\n */\nexport const testGyeonggiApiWithProxy = async (apiKey = '8b62aa70e514468596e9324d064d582d') => {\n  try {\n    // 올바른 엔드포인트 사용\n    const methods = [\n    // 1. 올바른 엔드포인트 직접 호출\n    {\n      name: 'Correct Endpoint',\n      url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}&Type=json&pIndex=1&pSize=5`\n    },\n    // 2. 추가 매개변수 포함\n    {\n      name: 'With Additional Params',\n      url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}&Type=json&pIndex=1&pSize=10`\n    },\n    // 3. 매개변수 순서 변경\n    {\n      name: 'Parameter Order Change',\n      url: `https://openapi.gg.go.kr/TBGGIBLLBR?Type=json&KEY=${apiKey}&pIndex=1&pSize=5`\n    },\n    // 4. 파라미터 없이 기본 호출\n    {\n      name: 'Basic Call',\n      url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}`\n    }];\n    for (const method of methods) {\n      try {\n        console.log(`🔄 ${method.name} 시도:`, method.url);\n        const response = await fetch(method.url, {\n          method: 'GET',\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          },\n          mode: 'cors'\n        });\n        console.log(`📊 ${method.name} 응답:`, response.status, response.statusText);\n        if (response.ok) {\n          const data = await response.json();\n          console.log(`✅ ${method.name} 성공:`, data);\n          return {\n            success: true,\n            message: `경기데이터드림 API 연결 성공 (${method.name})`,\n            details: {\n              method: method.name,\n              url: method.url,\n              data: data\n            }\n          };\n        } else {\n          const errorText = await response.text();\n          console.log(`❌ ${method.name} 실패:`, errorText);\n        }\n      } catch (error) {\n        console.log(`❌ ${method.name} 오류:`, error);\n      }\n    }\n    return {\n      success: false,\n      message: '모든 경기데이터드림 API 연결 방법 실패. CORS 문제이거나 API 키가 유효하지 않을 수 있습니다.',\n      details: {\n        attempted_methods: methods.map(m => m.name),\n        suggestion: 'API 키가 활성화될 때까지 기다리거나, 서버사이드에서 API를 호출하는 것을 고려해보세요.'\n      }\n    };\n  } catch (error) {\n    return {\n      success: false,\n      message: '경기데이터드림 API 테스트 중 오류 발생',\n      details: error\n    };\n  }\n};\n\n/**\n * API 연결 문제 해결 가이드\n */\nexport const getApiTroubleshootingGuide = () => {\n  return ['🔧 API 연결 문제 해결 방법:', '', '1. API 키 확인:', '   - 도서관정보나루: 651824a6d5a5d765b513f7f8059ef5ffb2ac3c30f15f0114a8764076c8b902b8', '   - 경기데이터드림: 8b62aa70e514468596e9324d064d582d', '', '2. API 키 활성화 상태:', '   - 신청 후 1-2시간 정도 소요될 수 있습니다', '   - 각 사이트에서 승인 상태를 확인해보세요', '', '3. CORS 문제 (브라우저 보안 정책):', '   - 브라우저에서 직접 호출 시 발생할 수 있습니다', '   - 개발 중에는 더미 데이터를 사용합니다', '   - 배포 시에는 서버사이드에서 API를 호출하세요', '', '4. 네트워크 문제:', '   - 인터넷 연결을 확인해보세요', '   - 방화벽이나 프록시 설정을 확인해보세요', '', '5. 현재 상태:', '   - 도서관정보나루 API: 정상 작동 중', '   - 경기데이터드림 API: 연결 문제 (CORS 또는 API 키)', '', '📞 문의처:', '   - 도서관정보나루: http://data4library.kr', '   - 경기데이터드림: https://data.gg.go.kr'];\n};\n\n/**\n * 현재 API 설정 정보 확인\n */\nexport const getApiStatus = () => {\n  const hasApiKey = Boolean(AUTH_KEY && AUTH_KEY !== 'your_actual_api_key_here' && AUTH_KEY.length > 10);\n  const isFromEnv = process.env.REACT_APP_LIBRARY_API_KEY !== undefined;\n  return {\n    configured: hasApiKey,\n    apiKey: AUTH_KEY ? `${AUTH_KEY.substring(0, 10)}...` : 'Not set',\n    message: hasApiKey ? `API 키 설정됨 (${isFromEnv ? '환경변수' : '코드'})` : 'API 키를 설정해주세요'\n  };\n};\n\n/**\n * 환경 설정 확인\n */\nexport const checkApiConfiguration = () => {\n  if (!AUTH_KEY || AUTH_KEY.length < 10) {\n    console.warn('⚠️ API 인증키가 설정되지 않았습니다. 더미 데이터를 사용합니다.');\n    return false;\n  }\n  console.log('✅ API 인증키가 설정되었습니다.');\n  return true;\n};\n\n/**\n * 실제 API 사용 예시\n */\nexport const exampleApiUsage = async () => {\n  try {\n    // 도서 검색 예시\n    console.log('=== 도서 검색 API 테스트 ===');\n    const searchResults = await searchBooksAPI('사피엔스', 1, 5);\n    console.log('검색 결과:', searchResults);\n\n    // 인기 도서 조회 예시\n    console.log('=== 인기 도서 API 테스트 ===');\n    const popularBooks = await fetchPopularBooks();\n    console.log('인기도서 목록:', popularBooks);\n    return {\n      searchResults,\n      popularBooks\n    };\n  } catch (error) {\n    console.error('API 사용 예시 오류:', error);\n    return {\n      searchResults: [],\n      popularBooks: []\n    };\n  }\n};\n\n/**\n * 브라우저에서 API 테스트를 위한 전역 함수\n */\nif (typeof window !== 'undefined') {\n  window.testLibraryAPI = async () => {\n    console.log('🔍 도서관 API 테스트 시작...');\n\n    // 1. API 설정 상태 확인\n    const apiStatus = getApiStatus();\n    console.log('📊 API 설정 상태:', apiStatus);\n\n    // 2. API 연결 테스트\n    try {\n      const connectionTest = await testApiConnection();\n      console.log('🔗 API 연결 테스트 결과:', connectionTest);\n      if (connectionTest.success) {\n        var _connectionTest$detai, _connectionTest$detai2, _connectionTest$detai3;\n        console.log('✅ 성공! 실제 도서관 데이터 사용 가능');\n        console.log('📚 도서 검색 결과:', (_connectionTest$detai = connectionTest.details) === null || _connectionTest$detai === void 0 ? void 0 : _connectionTest$detai.libraryBooks, '권');\n        console.log('🏛️ 경기도 도서관 수:', (_connectionTest$detai2 = connectionTest.details) === null || _connectionTest$detai2 === void 0 ? void 0 : _connectionTest$detai2.gyeonggiLibraries, '개');\n        console.log('📖 샘플 도서 데이터:', (_connectionTest$detai3 = connectionTest.details) === null || _connectionTest$detai3 === void 0 ? void 0 : _connectionTest$detai3.sampleBooks);\n      } else {\n        console.log('❌ 실패:', connectionTest.message);\n      }\n      return connectionTest;\n    } catch (error) {\n      console.error('🚨 API 테스트 오류:', error);\n      return {\n        success: false,\n        message: 'API 테스트 실행 오류',\n        details: error\n      };\n    }\n  };\n  window.searchLibraryBooks = async (query = '해리포터') => {\n    console.log(`🔍 도서 검색 테스트: \"${query}\"`);\n    try {\n      const results = await searchBooksAPI(query, 1, 5);\n      console.log('📚 검색 결과:', results);\n      if (results && results.length > 0) {\n        console.log(`✅ ${results.length}권의 도서를 찾았습니다!`);\n        results.forEach((book, index) => {\n          console.log(`${index + 1}. ${book.title} - ${book.author} (${book.publisher})`);\n        });\n      } else {\n        console.log('❌ 검색 결과가 없습니다.');\n      }\n      return results;\n    } catch (error) {\n      console.error('🚨 도서 검색 오류:', error);\n      return [];\n    }\n  };\n  window.testGyeonggiAPI = async () => {\n    console.log('🔍 경기데이터드림 API 단독 테스트...');\n    return await testGyeonggiApiWithProxy();\n  };\n  window.showApiGuide = () => {\n    console.log('📖 API 문제 해결 가이드:');\n    const guide = getApiTroubleshootingGuide();\n    guide.forEach(line => console.log(line));\n    return guide;\n  };\n}\n\n/**\n * 전체 API 시스템 종합 테스트\n */\nif (typeof window !== 'undefined') {\n  window.testAllLibraryAPIs = async () => {\n    console.log('🔥 === 도서관 API 종합 테스트 시작 === 🔥');\n    try {\n      // 1. 기본 API 연결 테스트\n      console.log('\\n1️⃣ 기본 API 연결 테스트...');\n      const connectionTest = await testApiConnection();\n      console.log('결과:', connectionTest);\n\n      // 2. 도서 검색 테스트\n      console.log('\\n2️⃣ 도서 검색 테스트...');\n      const searchResults = await searchBooksAPI('해리포터', 1, 5);\n      console.log('검색 결과:', searchResults);\n\n      // 3. 인기 도서 조회 테스트\n      console.log('\\n3️⃣ 인기 도서 조회 테스트...');\n      const popularBooks = await fetchPopularBooks();\n      console.log('인기 도서:', popularBooks);\n\n      // 4. 경기도 도서관 정보 테스트\n      console.log('\\n4️⃣ 경기도 도서관 정보 테스트...');\n      const libraryAPI = new LibraryAPIService({\n        baseURL: 'https://openapi.gg.go.kr',\n        apiKey: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d'\n      });\n      const libraries = await libraryAPI.getLibraries();\n      console.log('경기도 도서관 목록:', libraries.length, '개');\n      console.log('샘플 도서관:', libraries.slice(0, 3));\n\n      // 5. 종합 결과\n      console.log('\\n🎯 === 종합 테스트 결과 === 🎯');\n      console.log('✅ API 연결 상태:', connectionTest.success ? '성공' : '실패');\n      console.log('📚 검색 가능 도서 수:', searchResults.length, '권');\n      console.log('🔥 인기 도서 수:', popularBooks.length, '권');\n      console.log('🏛️ 경기도 도서관 수:', libraries.length, '개');\n      if (connectionTest.success && searchResults.length > 0) {\n        console.log('🎉 모든 API가 정상 작동하고 있습니다!');\n      } else {\n        console.log('⚠️ 일부 API에 문제가 있습니다. 더미 데이터를 사용합니다.');\n      }\n      return {\n        connectionTest,\n        searchResults,\n        popularBooks,\n        libraries: libraries.length\n      };\n    } catch (error) {\n      console.error('🚨 종합 테스트 오류:', error);\n      return null;\n    }\n  };\n}\n\n/**\n * 브라우저 콘솔에서 직접 테스트할 수 있는 함수\n * 사용법: testCorrectGyeonggiAPI()\n */\nexport const testCorrectGyeonggiAPI = async () => {\n  console.log('🔍 올바른 경기데이터드림 API 엔드포인트 테스트 시작...');\n  const apiKey = '8b62aa70e514468596e9324d064d582d';\n  const correctUrl = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}`;\n  try {\n    console.log('📞 API 호출:', correctUrl);\n    const response = await fetch(correctUrl);\n    console.log('📊 응답 상태:', response.status, response.statusText);\n    if (response.ok) {\n      const data = await response.json();\n      console.log('✅ API 연결 성공!');\n      console.log('📋 응답 데이터:', data);\n      if (data.TBGGIBLLBR && data.TBGGIBLLBR[1] && data.TBGGIBLLBR[1].row) {\n        console.log('📚 도서관 개수:', data.TBGGIBLLBR[1].row.length);\n        console.log('📍 첫 번째 도서관:', data.TBGGIBLLBR[1].row[0]);\n      }\n    } else {\n      console.log('❌ API 호출 실패:', response.status, response.statusText);\n    }\n  } catch (error) {\n    console.log('🚨 오류 발생:', error);\n  }\n};\n\n// 도서관정보나루 API 직접 테스트\nexport const testLibraryAPI = async () => {\n  const apiKey = process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY;\n  console.log('🔑 사용 중인 API 키:', `${apiKey.substring(0, 10)}...`);\n\n  // 1. 간단한 도서관 조회 API 테스트\n  const libTestUrl = `http://data4library.kr/api/libSrch?authKey=${apiKey}&pageNo=1&pageSize=5`;\n  console.log('🏛️ 도서관 조회 API 테스트:', libTestUrl);\n  try {\n    const response = await fetch(libTestUrl);\n    const data = await response.text(); // 먼저 text로 받아보기\n\n    console.log('📄 도서관 조회 API 응답 (원본):', data);\n\n    // XML 응답을 JSON으로 파싱 시도\n    try {\n      const jsonData = JSON.parse(data);\n      console.log('✅ JSON 파싱 성공:', jsonData);\n    } catch (parseError) {\n      console.log('⚠️ JSON 파싱 실패, XML 응답인 것 같습니다');\n    }\n  } catch (error) {\n    console.error('❌ 도서관 조회 API 테스트 실패:', error);\n  }\n\n  // 2. 인기대출도서 API 테스트\n  const popularTestUrl = `http://data4library.kr/api/loanItemSrch?authKey=${apiKey}&startDt=2023-01-01&endDt=2023-12-31&pageNo=1&pageSize=5`;\n  console.log('🏆 인기대출도서 API 테스트:', popularTestUrl);\n  try {\n    const response = await fetch(popularTestUrl);\n    const data = await response.text(); // 먼저 text로 받아보기\n\n    console.log('📄 인기대출도서 API 응답 (원본):', data.substring(0, 500) + '...');\n\n    // XML 응답을 JSON으로 파싱 시도\n    try {\n      const jsonData = JSON.parse(data);\n      console.log('✅ JSON 파싱 성공:', jsonData);\n    } catch (parseError) {\n      console.log('⚠️ JSON 파싱 실패, XML 응답 처리 중...');\n      const xmlData = parseXMLResponse(data);\n      console.log('✅ XML 파싱 성공:', xmlData);\n      console.log('📊 추출된 도서 수:', xmlData.response.docs.length);\n    }\n  } catch (error) {\n    console.error('❌ 인기대출도서 API 테스트 실패:', error);\n  }\n};\n\n// 전역 객체에 함수 추가 (브라우저 콘솔에서 쉽게 접근)\nif (typeof window !== 'undefined') {\n  window.testCorrectGyeonggiAPI = testCorrectGyeonggiAPI;\n  window.testLibraryAPI = testLibraryAPI;\n}","map":{"version":3,"names":["dummyLibraries","id","name","address","phone","hours","website","distance","coordinates","lat","lng","type","dummyBooks","title","author","publisher","isbn","category","publishYear","description","imageUrl","dummyReadingGroups","libraryId","libraryName","meetingDate","meetingTime","maxMembers","currentMembers","bookTitle","bookAuthor","difficulty","meetingType","organizer","contact","status","LibraryAPIService","constructor","config","getLibraries","location","radius","apiUrl","params","URLSearchParams","KEY","process","env","REACT_APP_GYEONGGI_API_KEY","Type","pIndex","pSize","response","fetch","ok","Error","data","json","libraries","TBGGIBLLBR","row","map","item","index","toString","LBRRY_NM","REFINE_ROADNM_ADDR","REFINE_LOTNO_ADDR","TELNO","OPER_TIME","HMPG_ADDR","Math","round","random","parseFloat","REFINE_WGS84_LAT","REFINE_WGS84_LOGT","additionalLibraries","error","console","log","searchBooks","_data$response","_data$response2","cleanQuery","query","trim","replace","searchParams","authKey","REACT_APP_LIBRARY_API_KEY","AUTH_KEY","pageNo","pageSize","format","statusText","JSON","stringify","docs","numFound","authorSearchParams","authorResponse","authorData","rawBooks","length","bookname","doc","filter","book","Array","isArray","result","books","hasTitle","isbn13","authors","class_nm","publication_year","bookImageURL","loanCount","parseInt","loan_count","warn","getDummyBooksForQuery","searchTerm","Date","now","getBookAvailability","region","regionCodes","regionCode","includes","nationalParams","nationalResponse","nationalData","libs","availability","lib","_lib$lib","_lib$lib2","_lib$book","_lib$book2","_lib$book3","_lib$book4","libCode","libName","available","loanAvailable","loanable","reservable","reserveAvailable","dueDate","returnPlanDate","undefined","reserveBook","bookId","userId","getReadingGroups","group","joinReadingGroup","groupId","createReadingGroup","groupData","defaultLibraryAPI","baseURL","REACT_APP_GYEONGGI_API_URL","apiKey","API_SETUP_GUIDE","steps","step","url","note","code","additionalAPIs","apis","BASE_URL","checkApiApprovalStatus","_data$message","_data$message2","message","parseXMLResponse","xmlString","parser","DOMParser","xmlDoc","parseFromString","parseError","getElementsByTagName","textContent","i","getTextContent","tagName","element","ranking","push","start","fetchPopularBooks","startDate","endDate","defaultEndDate","defaultStartDate","actualStartDate","actualEndDate","_data$response3","_data$response4","_data$response4$docs","_rawBooks","startDt","endDt","responseText","text","substring","parse","jsonError","getFallbackPopularBooks","searchBooksAPI","apiService","testApiConnection","testQuery","searchUrl","keyword","libraryResponse","libraryData","gyeonggiApiKey","gyeonggiResponse","gyeonggiData","gyeonggiUrl1","gyeonggiParams1","gyeonggiUrl2","error2","gyeonggiUrl3","error3","libraryApiSuccess","gyeonggiApiSuccess","_gyeonggiData$TBGGIBL","success","details","libraryBooks","gyeonggiLibraries","sampleBooks","slice","_gyeonggiData","failureAnalysis","libraryApi","gyeonggiApi","testGyeonggiApiWithProxy","methods","method","headers","mode","errorText","attempted_methods","m","suggestion","getApiTroubleshootingGuide","getApiStatus","hasApiKey","Boolean","isFromEnv","configured","checkApiConfiguration","exampleApiUsage","searchResults","popularBooks","window","testLibraryAPI","apiStatus","connectionTest","_connectionTest$detai","_connectionTest$detai2","_connectionTest$detai3","searchLibraryBooks","results","forEach","testGyeonggiAPI","showApiGuide","guide","line","testAllLibraryAPIs","libraryAPI","testCorrectGyeonggiAPI","correctUrl","libTestUrl","jsonData","popularTestUrl","xmlData"],"sources":["C:/Users/qoo/Desktop/zziyoonii/senior/src/services/LibraryAPI.ts"],"sourcesContent":["import { LatLng } from 'leaflet';\n\n// 더미 데이터 - 경기도 도서관 (시립 중앙도서관 + 동네 작은도서관)\nexport const dummyLibraries = [\n  // 수원시 도서관들\n  {\n    id: '1',\n    name: '경기도립중앙도서관',\n    address: '경기 수원시 영통구 월드컵로 235',\n    phone: '031-249-4800',\n    hours: '09:00-18:00',\n    website: 'https://www.library.kr/',\n    distance: 0.8,\n    coordinates: { lat: 37.299, lng: 127.070 },\n    type: '공공도서관'\n  },\n  {\n    id: '2',\n    name: '수원시립중앙도서관',\n    address: '경기 수원시 영통구 광교로 183',\n    phone: '031-228-4300',\n    hours: '09:00-22:00',\n    website: 'https://www.suwonlib.go.kr/',\n    distance: 1.2,\n    coordinates: { lat: 37.295, lng: 127.075 },\n    type: '공공도서관'\n  },\n  {\n    id: '3',\n    name: '영통구립도서관',\n    address: '경기 수원시 영통구 영통동 999-1',\n    phone: '031-228-4350',\n    hours: '09:00-20:00',\n    website: 'https://www.suwonlib.go.kr/',\n    distance: 1.5,\n    coordinates: { lat: 37.293, lng: 127.073 },\n    type: '구립도서관'\n  },\n  {\n    id: '4',\n    name: '광교작은도서관',\n    address: '경기 수원시 영통구 광교동 1275',\n    phone: '031-228-4380',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 1.8,\n    coordinates: { lat: 37.291, lng: 127.077 },\n    type: '작은도서관'\n  },\n  {\n    id: '5',\n    name: '망포작은도서관',\n    address: '경기 수원시 영통구 망포동 578-2',\n    phone: '031-228-4390',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 2.1,\n    coordinates: { lat: 37.285, lng: 127.065 },\n    type: '작은도서관'\n  },\n  \n  // 성남시 도서관들\n  {\n    id: '6',\n    name: '성남시립중앙도서관',\n    address: '경기 성남시 분당구 양현로 346',\n    phone: '031-729-4600',\n    hours: '09:00-18:00',\n    website: 'https://www.snlib.go.kr/',\n    distance: 2.5,\n    coordinates: { lat: 37.350, lng: 127.105 },\n    type: '공공도서관'\n  },\n  {\n    id: '7',\n    name: '분당구립정자도서관',\n    address: '경기 성남시 분당구 정자동 178-1',\n    phone: '031-729-4650',\n    hours: '09:00-20:00',\n    website: 'https://www.snlib.go.kr/',\n    distance: 2.8,\n    coordinates: { lat: 37.365, lng: 127.110 },\n    type: '구립도서관'\n  },\n  {\n    id: '8',\n    name: '서현작은도서관',\n    address: '경기 성남시 분당구 서현동 271-3',\n    phone: '031-729-4670',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 3.1,\n    coordinates: { lat: 37.348, lng: 127.123 },\n    type: '작은도서관'\n  },\n  {\n    id: '9',\n    name: '야탑작은도서관',\n    address: '경기 성남시 분당구 야탑동 344-10',\n    phone: '031-729-4680',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 3.3,\n    coordinates: { lat: 37.341, lng: 127.128 },\n    type: '작은도서관'\n  },\n  \n  // 고양시 도서관들\n  {\n    id: '10',\n    name: '고양시립중앙도서관',\n    address: '경기 고양시 덕양구 고양대로 1955',\n    phone: '031-8075-9300',\n    hours: '09:00-18:00',\n    website: 'https://www.goyanglib.go.kr/',\n    distance: 4.2,\n    coordinates: { lat: 37.650, lng: 126.830 },\n    type: '공공도서관'\n  },\n  {\n    id: '11',\n    name: '일산동구립도서관',\n    address: '경기 고양시 일산동구 백석동 1256',\n    phone: '031-8075-9350',\n    hours: '09:00-20:00',\n    website: 'https://www.goyanglib.go.kr/',\n    distance: 4.5,\n    coordinates: { lat: 37.670, lng: 126.775 },\n    type: '구립도서관'\n  },\n  {\n    id: '12',\n    name: '백석작은도서관',\n    address: '경기 고양시 일산동구 백석동 1234-5',\n    phone: '031-8075-9380',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 4.8,\n    coordinates: { lat: 37.675, lng: 126.780 },\n    type: '작은도서관'\n  },\n  {\n    id: '13',\n    name: '마두작은도서관',\n    address: '경기 고양시 일산동구 마두동 775-2',\n    phone: '031-8075-9390',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 5.1,\n    coordinates: { lat: 37.655, lng: 126.785 },\n    type: '작은도서관'\n  },\n  \n  // 부천시 도서관들\n  {\n    id: '14',\n    name: '부천시립중앙도서관',\n    address: '경기 부천시 원미구 길주로 1',\n    phone: '032-625-4700',\n    hours: '09:00-18:00',\n    website: 'https://www.bclib.go.kr/',\n    distance: 3.1,\n    coordinates: { lat: 37.490, lng: 126.783 },\n    type: '공공도서관'\n  },\n  {\n    id: '15',\n    name: '원미구립도서관',\n    address: '경기 부천시 원미구 중동 1033-3',\n    phone: '032-625-4750',\n    hours: '09:00-20:00',\n    website: 'https://www.bclib.go.kr/',\n    distance: 3.4,\n    coordinates: { lat: 37.485, lng: 126.788 },\n    type: '구립도서관'\n  },\n  {\n    id: '16',\n    name: '중동작은도서관',\n    address: '경기 부천시 원미구 중동 1178-1',\n    phone: '032-625-4780',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 3.7,\n    coordinates: { lat: 37.488, lng: 126.791 },\n    type: '작은도서관'\n  },\n  {\n    id: '17',\n    name: '역곡작은도서관',\n    address: '경기 부천시 원미구 역곡동 201-8',\n    phone: '032-625-4790',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 4.0,\n    coordinates: { lat: 37.486, lng: 126.794 },\n    type: '작은도서관'\n  },\n  \n  // 안양시 도서관들\n  {\n    id: '18',\n    name: '안양시립중앙도서관',\n    address: '경기 안양시 만안구 문예로 30',\n    phone: '031-389-0800',\n    hours: '09:00-22:00',\n    website: 'https://www.aylib.go.kr/',\n    distance: 3.8,\n    coordinates: { lat: 37.400, lng: 126.950 },\n    type: '공공도서관'\n  },\n  {\n    id: '19',\n    name: '만안구립도서관',\n    address: '경기 안양시 만안구 안양동 678-49',\n    phone: '031-389-0850',\n    hours: '09:00-20:00',\n    website: 'https://www.aylib.go.kr/',\n    distance: 4.1,\n    coordinates: { lat: 37.395, lng: 126.955 },\n    type: '구립도서관'\n  },\n  {\n    id: '20',\n    name: '안양동작은도서관',\n    address: '경기 안양시 만안구 안양동 123-45',\n    phone: '031-389-0880',\n    hours: '10:00-18:00',\n    website: '',\n    distance: 4.4,\n    coordinates: { lat: 37.398, lng: 126.958 },\n    type: '작은도서관'\n  },\n  \n  // 용인시 도서관들\n  {\n    id: '21',\n    name: '용인시립중앙도서관',\n    address: '경기 용인시 처인구 중부대로 1199',\n    phone: '031-324-4800',\n    hours: '09:00-18:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 4.8,\n    coordinates: { lat: 37.230, lng: 127.208 },\n    type: '공공도서관'\n  },\n  {\n    id: '22',\n    name: '수지구립도서관',\n    address: '경기 용인시 수지구 수지동 1234-1',\n    phone: '031-324-4850',\n    hours: '09:00-20:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 5.1,\n    coordinates: { lat: 37.325, lng: 127.095 },\n    type: '구립도서관'\n  },\n  {\n    id: '23',\n    name: '기흥구립도서관',\n    address: '경기 용인시 기흥구 구갈동 567-8',\n    phone: '031-324-4880',\n    hours: '09:00-20:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 5.4,\n    coordinates: { lat: 37.275, lng: 127.115 },\n    type: '구립도서관'\n  },\n  {\n    id: '23-1',\n    name: '처인도서관',\n    address: '경기 용인시 처인구 금령로 33번길 15',\n    phone: '031-324-4670',\n    hours: '09:00-18:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 5.6,\n    coordinates: { lat: 37.236, lng: 127.200 },\n    type: '공공도서관'\n  },\n  {\n    id: '23-2',\n    name: '서농도서관',\n    address: '경기 용인시 기흥구 서천서로 83',\n    phone: '031-324-4680',\n    hours: '09:00-18:00',\n    website: '',\n    distance: 5.8,\n    coordinates: { lat: 37.241, lng: 127.077 },\n    type: '공공도서관'\n  },\n  {\n    id: '23-3',\n    name: '포곡도서관',\n    address: '경기 용인시 처인구 포곡읍 에버랜드로 860',\n    phone: '031-324-4690',\n    hours: '09:00-18:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 6.0,\n    coordinates: { lat: 37.294, lng: 127.202 },\n    type: '공공도서관'\n  },\n  {\n    id: '23-4',\n    name: '흥덕도서관',\n    address: '경기 용인시 기흥구 흥덕중앙로 120',\n    phone: '031-324-4700',\n    hours: '09:00-18:00',\n    website: 'https://www.yonginlib.go.kr/',\n    distance: 5.2,\n    coordinates: { lat: 37.238, lng: 127.119 },\n    type: '공공도서관'\n  },\n  \n  // 화성시 도서관들\n  {\n    id: '24',\n    name: '화성시립중앙도서관',\n    address: '경기 화성시 남양읍 시청로 155',\n    phone: '031-369-6800',\n    hours: '09:00-18:00',\n    website: 'https://www.hscitylib.go.kr/',\n    distance: 6.2,\n    coordinates: { lat: 37.200, lng: 126.831 },\n    type: '공공도서관'\n  },\n  {\n    id: '25',\n    name: '동탄구립도서관',\n    address: '경기 화성시 동탄면 동탄대로 300',\n    phone: '031-369-6850',\n    hours: '09:00-20:00',\n    website: 'https://www.hscitylib.go.kr/',\n    distance: 6.5,\n    coordinates: { lat: 37.205, lng: 127.078 },\n    type: '구립도서관'\n  }\n];\n\n// 더미 도서 데이터\nexport const dummyBooks = [\n  {\n    id: 1,\n    title: '82년생 김지영',\n    author: '조남주',\n    publisher: '민음사',\n    isbn: '9788937473722',\n    category: '소설',\n    publishYear: '2016',\n    description: '한국 여성의 현실을 담은 화제의 소설',\n    imageUrl: ''\n  },\n  {\n    id: 2,\n    title: '미드나잇 라이브러리',\n    author: '매트 헤이그',\n    publisher: '인플루엔셜',\n    isbn: '9791197377109',\n    category: '소설',\n    publishYear: '2020',\n    description: '후회와 선택에 관한 철학적 소설',\n    imageUrl: ''\n  },\n  {\n    id: 3,\n    title: '사피엔스',\n    author: '유발 하라리',\n    publisher: '김영사',\n    isbn: '9788934972464',\n    category: '인문',\n    publishYear: '2015',\n    description: '인류의 역사를 다룬 베스트셀러',\n    imageUrl: ''\n  },\n  {\n    id: 4,\n    title: '아몬드',\n    author: '손원평',\n    publisher: '창비',\n    isbn: '9788936434267',\n    category: '소설',\n    publishYear: '2017',\n    description: '감정을 느끼지 못하는 소년의 성장 소설',\n    imageUrl: ''\n  },\n  {\n    id: 5,\n    title: '정의란 무엇인가',\n    author: '마이클 샌델',\n    publisher: '김영사',\n    isbn: '9788934942467',\n    category: '철학',\n    publishYear: '2010',\n    description: '정의에 대한 철학적 탐구',\n    imageUrl: ''\n  }\n];\n\n// 더미 독서모임 데이터\nexport const dummyReadingGroups = [\n  {\n    id: 1,\n    name: '시니어 독서 클럽',\n    description: '50-60대를 위한 독서 모임입니다.',\n    libraryId: '1',\n    libraryName: '경기도립중앙도서관',\n    meetingDate: '2024-01-15',\n    meetingTime: '14:00',\n    maxMembers: 15,\n    currentMembers: 8,\n    bookTitle: '82년생 김지영',\n    bookAuthor: '조남주',\n    category: '소설',\n    difficulty: '쉬움',\n    meetingType: 'library',\n    organizer: '김도서',\n    contact: '010-1234-5678',\n    status: 'active'\n  },\n  {\n    id: 2,\n    name: '역사 탐구 모임',\n    description: '한국사와 세계사를 함께 읽는 모임',\n    libraryId: '2',\n    libraryName: '수원시립중앙도서관',\n    meetingDate: '2024-01-20',\n    meetingTime: '10:00',\n    maxMembers: 12,\n    currentMembers: 6,\n    bookTitle: '사피엔스',\n    bookAuthor: '유발 하라리',\n    category: '인문',\n    difficulty: '보통',\n    meetingType: 'library',\n    organizer: '박역사',\n    contact: '010-2345-6789',\n    status: 'active'\n  }\n];\n\nexport interface LibraryAPIConfig {\n  baseURL: string;\n  apiKey: string;\n}\n\nexport interface GyeonggiLibraryData {\n  libraryName: string;\n  address: string;\n  phoneNumber: string;\n  website?: string;\n  operatingHours: string;\n  latitude?: number;\n  longitude?: number;\n  libraryType: string;\n}\n\nexport interface BookSearchParams {\n  query: string;\n  libraryId?: string;\n  startDate?: string;\n  endDate?: string;\n  pageNo?: number;\n  pageSize?: number;\n}\n\nexport interface BookSearchResult {\n  id: string;\n  title: string;\n  author: string;\n  publisher: string;\n  isbn: string;\n  category: string;\n  publishYear: string;\n  description?: string;\n  imageUrl?: string;\n  loanCount?: number;\n  availability?: LibraryAvailability[];\n}\n\nexport interface LibraryAvailability {\n  libraryId: string;\n  libraryName: string;\n  available: boolean;\n  loanable: boolean;\n  reservable: boolean;\n  dueDate?: string;\n}\n\n/**\n * 경기도 공공데이터 API 서비스 클래스\n * 실제 구현 시 아래 API들을 활용할 수 있습니다:\n * \n * 1. 경기데이터드림 (data.gg.go.kr)\n *    - 경기도 도서관 정보 API\n *    - 도서관 시설 현황 API\n *    - 문화시설 통합 정보 API\n * \n * 2. 도서관정보나루 (data4library.kr) \n *    - 전국 도서관 표준 API\n *    - 도서 검색 API\n *    - 대출/예약 현황 API\n * \n * 3. 서울열린데이터광장 등 시군별 Open API\n *    - 각 시군별 도서관 API\n *    - 지역별 문화시설 API\n */\nexport class LibraryAPIService {\n  private config: LibraryAPIConfig;\n\n  constructor(config: LibraryAPIConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 경기도 도서관 목록 조회\n   * 실제 API: https://openapi.gg.go.kr/TBGGIBLLBR\n   */\n  async getLibraries(location?: LatLng, radius?: number): Promise<any[]> {\n    try {\n      // 경기데이터드림 도서관 현황 API 호출 (올바른 엔드포인트)\n      const apiUrl = `https://openapi.gg.go.kr/TBGGIBLLBR`;\n      const params = new URLSearchParams({\n        KEY: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d',\n        Type: 'json',\n        pIndex: '1',\n        pSize: '500' // 검색 범위 확대\n      });\n\n      const response = await fetch(`${apiUrl}?${params}`);\n      \n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      // 경기데이터드림 API 응답 구조에 맞게 데이터 변환\n      let libraries = [];\n      if (data.TBGGIBLLBR && data.TBGGIBLLBR[1] && data.TBGGIBLLBR[1].row) {\n        libraries = data.TBGGIBLLBR[1].row.map((item: any, index: number) => ({\n          id: (index + 1).toString(),\n          name: item.LBRRY_NM || '도서관명 없음',\n          address: item.REFINE_ROADNM_ADDR || item.REFINE_LOTNO_ADDR || '주소 없음',\n          phone: item.TELNO || '전화번호 없음',\n          hours: item.OPER_TIME || '09:00-18:00', // 실제 운영시간 사용\n          website: item.HMPG_ADDR || '',\n          distance: Math.round(Math.random() * 5 * 10) / 10, // 임시 거리 계산\n          coordinates: {\n            lat: parseFloat(item.REFINE_WGS84_LAT) || 37.5,\n            lng: parseFloat(item.REFINE_WGS84_LOGT) || 127.0\n          },\n          type: '공공도서관'\n        }));\n      }\n\n      // 용인시 도서관들 수동 추가 (API에서 검색되지 않는 경우 대비)\n      const additionalLibraries = [\n        {\n          id: 'yongin_central',\n          name: '용인시립중앙도서관',\n          address: '경기도 용인시 처인구 중부대로 1199',\n          phone: '031-324-4600',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 1.2,\n          coordinates: { lat: 37.231, lng: 127.208 },\n          type: '공공도서관'\n        },\n        {\n          id: 'giheung_lib',\n          name: '기흥도서관',\n          address: '경기도 용인시 기흥구 기흥로 19',\n          phone: '031-324-4660',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 1.8,\n          coordinates: { lat: 37.275, lng: 127.115 },\n          type: '공공도서관'\n        },\n        {\n          id: 'suji_lib',\n          name: '수지도서관',\n          address: '경기도 용인시 수지구 포은대로 435',\n          phone: '031-324-4650',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 2.1,\n          coordinates: { lat: 37.324, lng: 127.094 },\n          type: '공공도서관'\n        },\n        {\n          id: 'cheoin_lib',\n          name: '처인도서관',\n          address: '경기도 용인시 처인구 금령로 33번길 15',\n          phone: '031-324-4670',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 2.3,\n          coordinates: { lat: 37.236, lng: 127.200 },\n          type: '공공도서관'\n        },\n        {\n          id: 'seongnam_lib',\n          name: '서농도서관',\n          address: '경기도 용인시 기흥구 서천서로 83',\n          phone: '031-324-4680',\n          hours: '09:00-18:00',\n          website: '',\n          distance: 2.5,\n          coordinates: { lat: 37.241, lng: 127.077 },\n          type: '공공도서관'\n        },\n        {\n          id: 'pogok_lib',\n          name: '포곡도서관',\n          address: '경기도 용인시 처인구 포곡읍 에버랜드로 860',\n          phone: '031-324-4690',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 3.2,\n          coordinates: { lat: 37.294, lng: 127.202 },\n          type: '공공도서관'\n        },\n        {\n          id: 'heungdeok_lib',\n          name: '흥덕도서관',\n          address: '경기도 용인시 기흥구 흥덕중앙로 120',\n          phone: '031-324-4700',\n          hours: '09:00-18:00',\n          website: 'https://www.yonginlib.go.kr',\n          distance: 2.8,\n          coordinates: { lat: 37.238, lng: 127.119 },\n          type: '공공도서관'\n        }\n      ];\n\n      return [...libraries, ...additionalLibraries];\n      \n    } catch (error) {\n      console.error('도서관 정보 조회 실패:', error);\n      console.log('더미 데이터로 대체합니다.');\n      return dummyLibraries; // 오류 시 더미 데이터 반환\n    }\n  }\n\n  /**\n   * 도서 검색 - 도서관정보나루 API 활용\n   * 실제 API: http://data4library.kr/api/srchBooks\n   */\n  async searchBooks(params: BookSearchParams): Promise<BookSearchResult[]> {\n    try {\n      const apiUrl = 'http://data4library.kr/api/srchBooks';\n      \n      // 검색어 전처리 및 인코딩\n      const cleanQuery = params.query.trim().replace(/\\s+/g, ' ');\n      \n      const searchParams = new URLSearchParams({\n        authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n        title: cleanQuery,\n        pageNo: (params.pageNo || 1).toString(),\n        pageSize: (params.pageSize || 10).toString(),\n        format: 'json'\n      });\n\n      console.log('🔍 도서 검색 API 호출:', `${apiUrl}?${searchParams}`);\n      console.log('🔍 검색어:', cleanQuery);\n      \n      const response = await fetch(`${apiUrl}?${searchParams}`);\n      \n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status} ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      \n      console.log('📊 도서검색 API 전체 응답:', JSON.stringify(data, null, 2));\n      \n      // API 응답 구조 분석\n      console.log('🔍 도서검색 API 응답 구조 분석:');\n      console.log('- data.response:', data.response);\n      console.log('- data.response.docs:', data.response?.docs);\n      console.log('- data.response.numFound:', data.response?.numFound);\n      \n      // 결과가 없는 경우 다른 방식으로 재시도\n      if (data.response && data.response.numFound === 0) {\n        console.log('⚠️ 첫 번째 검색에서 결과 없음, 다른 방식으로 재시도');\n        \n        // 작가명으로 검색해보기\n        const authorSearchParams = new URLSearchParams({\n          authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n          author: cleanQuery,\n          pageNo: (params.pageNo || 1).toString(),\n          pageSize: (params.pageSize || 10).toString(),\n          format: 'json'\n        });\n        \n        console.log('🔍 작가명으로 재검색:', `${apiUrl}?${authorSearchParams}`);\n        \n        const authorResponse = await fetch(`${apiUrl}?${authorSearchParams}`);\n        if (authorResponse.ok) {\n          const authorData = await authorResponse.json();\n          console.log('📊 작가명 검색 결과:', JSON.stringify(authorData, null, 2));\n          \n          if (authorData.response && authorData.response.numFound > 0) {\n            data.response = authorData.response;\n          }\n        }\n      }\n      \n      // API 응답 구조 확인 및 데이터 추출\n      let rawBooks = [];\n      if (data.response && data.response.docs && data.response.docs.length > 0) {\n        // 각 docs 요소에서 doc 객체 추출\n        rawBooks = data.response.docs.map((item: any) => {\n          // item이 직접 도서 데이터인지 확인\n          if (item.bookname || item.title) {\n            return item;\n          }\n          // 또는 item.doc 형태인지 확인\n          if (item.doc) {\n            return item.doc;\n          }\n          return item;\n        }).filter((doc: any) => doc && (doc.bookname || doc.title));\n      } else if (data.response && data.response.book) {\n        rawBooks = Array.isArray(data.response.book) ? data.response.book : [data.response.book];\n      } else if (data.response && data.response.result) {\n        rawBooks = data.response.result.docs || data.response.result;\n      }\n      \n      console.log('📚 원본 도서 데이터:', rawBooks);\n      \n      if (rawBooks && rawBooks.length > 0) {\n        const books: BookSearchResult[] = rawBooks\n          .filter((book: any) => {\n            console.log('📖 개별 도서 데이터 확인:', book);\n            const hasTitle = book.bookname || book.title;\n            return hasTitle && hasTitle.trim() !== '';\n          })\n          .map((book: any, index: number) => ({\n            id: book.isbn13 || book.isbn || `book_${index}`,\n            title: (book.bookname || book.title || '').trim(),\n            author: book.authors || book.author || '작가 미상',\n            publisher: book.publisher || '출판사 미상',\n            isbn: book.isbn13 || book.isbn || '',\n            category: book.class_nm || book.category || '일반',\n            publishYear: book.publication_year || book.publishYear || '2023',\n            description: book.description || '',\n            imageUrl: book.bookImageURL || book.imageUrl || '',\n            loanCount: parseInt(book.loan_count || book.loanCount || '0') || 0\n          }));\n        \n        console.log('✅ 변환된 도서 데이터:', books);\n        console.log(`🎯 제목이 있는 도서 ${books.length}권을 찾았습니다.`);\n        return books;\n      }\n      \n      // API 응답이 예상과 다른 경우 검색어 기반 더미 데이터 생성\n      console.warn('⚠️ API 응답 구조가 예상과 다름, 검색어 기반 더미 데이터 생성');\n      return this.getDummyBooksForQuery(params.query);\n      \n    } catch (error) {\n      console.error('💥 도서 검색 실패:', error);\n      console.log('🔄 검색어 기반 더미 데이터로 대체합니다.');\n      return this.getDummyBooksForQuery(params.query);\n    }\n  }\n\n  /**\n   * 검색어 기반 더미 데이터 생성\n   */\n  private getDummyBooksForQuery(query: string): BookSearchResult[] {\n    const searchTerm = query.trim();\n    \n    // 검색어에 따른 맞춤 더미 데이터\n    const dummyBooks: BookSearchResult[] = [\n      {\n        id: `dummy_${Date.now()}`,\n        title: searchTerm,\n        author: '작가 미상',\n        publisher: '출판사 정보 없음',\n        isbn: '9788000000000',\n        category: '일반',\n        publishYear: '2023',\n        description: `\"${searchTerm}\"에 대한 검색 결과입니다. 정확한 도서 정보는 직접 도서관에 문의해 주세요.`,\n        imageUrl: '',\n        loanCount: 0\n      }\n    ];\n    \n    console.log(`🎯 검색어 \"${searchTerm}\" 기반 더미 데이터 생성:`, dummyBooks);\n    return dummyBooks;\n  }\n\n\n\n  /**\n   * 도서 소장 현황 조회 - 도서관정보나루 API 활용\n   * 실제 API: http://data4library.kr/api/libSrchByBook\n   */\n  async getBookAvailability(isbn: string, region: string = '41'): Promise<LibraryAvailability[]> {\n    try {\n      const apiUrl = 'http://data4library.kr/api/libSrchByBook';\n      \n      // 지역코드 매핑 (경기도: 41, 서울: 11, 부산: 26, 대구: 27, 인천: 28, 광주: 29, 대전: 30, 울산: 31, 세종: 36, 강원: 42, 충북: 43, 충남: 44, 전북: 45, 전남: 46, 경북: 47, 경남: 48, 제주: 50)\n      const regionCodes: Record<string, string> = {\n        '서울': '11',\n        '부산': '26',\n        '대구': '27',\n        '인천': '28',\n        '광주': '29',\n        '대전': '30',\n        '울산': '31',\n        '세종': '36',\n        '경기': '41',\n        '경기도': '41',\n        '강원': '42',\n        '충북': '43',\n        '충남': '44',\n        '전북': '45',\n        '전남': '46',\n        '경북': '47',\n        '경남': '48',\n        '제주': '50'\n      };\n      \n      // 지역명을 코드로 변환\n      const regionCode = regionCodes[region] || region || '41'; // 기본값: 경기도\n      \n      const params = new URLSearchParams({\n        authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n        isbn: isbn,\n        region: regionCode,\n        format: 'json'\n      });\n\n      console.log('📚 도서 소장 현황 API 호출:', `${apiUrl}?${params}`);\n      console.log('🗺️ 지역:', region, '→ 지역코드:', regionCode);\n      \n      const response = await fetch(`${apiUrl}?${params}`);\n      \n      if (!response.ok) {\n        throw new Error(`API 호출 실패: ${response.status} ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      \n      console.log('📊 소장 현황 API 전체 응답:', JSON.stringify(data, null, 2));\n      \n      // 에러 응답 체크\n      if (data.response && data.response.error) {\n        console.error('❌ API 에러:', data.response.error);\n        \n        // 지역코드 에러인 경우 다른 지역으로 재시도\n        if (data.response.error.includes('지역코드')) {\n          console.log('⚠️ 지역코드 에러, 전국 검색으로 재시도');\n          \n          // 전국 검색 (지역코드 없이)\n          const nationalParams = new URLSearchParams({\n            authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n            isbn: isbn,\n            format: 'json'\n          });\n          \n          const nationalResponse = await fetch(`${apiUrl}?${nationalParams}`);\n          if (nationalResponse.ok) {\n            const nationalData = await nationalResponse.json();\n            console.log('🌍 전국 검색 결과:', JSON.stringify(nationalData, null, 2));\n            \n            if (nationalData.response && nationalData.response.libs) {\n              data.response = nationalData.response;\n            }\n          }\n        }\n      }\n      \n      if (data.response && data.response.libs && data.response.libs.length > 0) {\n        const availability: LibraryAvailability[] = data.response.libs.map((lib: any) => ({\n          libraryId: lib.lib?.libCode || lib.libCode || '',\n          libraryName: lib.lib?.libName || lib.libName || '도서관명 없음',\n          available: lib.book?.loanAvailable === 'Y' || lib.loanAvailable === 'Y',\n          loanable: lib.book?.loanAvailable === 'Y' || lib.loanAvailable === 'Y',\n          reservable: lib.book?.reserveAvailable === 'Y' || lib.reserveAvailable === 'Y',\n          dueDate: lib.book?.returnPlanDate || lib.returnPlanDate || undefined\n        }));\n        \n        console.log('✅ 소장 현황 조회 성공:', availability);\n        return availability;\n      }\n      \n      console.log('⚠️ 소장 정보 없음 또는 구조 다름');\n      return [];\n      \n    } catch (error) {\n      console.error('💥 도서 소장 현황 조회 실패:', error);\n      \n      // 에러 발생 시 빈 배열 반환 (더미 데이터는 제거)\n      return [];\n    }\n  }\n\n  /**\n   * 도서 예약\n   * 실제 API: 각 도서관별 대출/예약 시스템 API\n   */\n  async reserveBook(bookId: string, libraryId: string, userId: string): Promise<boolean> {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/books/reserve`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ bookId, libraryId, userId, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n      \n      // 현재는 더미 응답 반환\n      console.log(`도서 예약 요청: 도서 ${bookId}, 도서관 ${libraryId}, 사용자 ${userId}`);\n      return true;\n    } catch (error) {\n      console.error('도서 예약 실패:', error);\n      return false;\n    }\n  }\n\n  /**\n   * 독서 모임 조회\n   * 실제 API: 각 도서관별 프로그램 API 또는 커뮤니티 API\n   */\n  async getReadingGroups(libraryId?: string): Promise<any[]> {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups?libraryId=${libraryId}&apiKey=${this.config.apiKey}`);\n      // const data = await response.json();\n      // return data.result;\n      \n      // 현재는 더미 데이터 반환\n      if (libraryId) {\n        return dummyReadingGroups.filter(group => group.libraryId === libraryId);\n      }\n      return dummyReadingGroups;\n    } catch (error) {\n      console.error('독서 모임 조회 실패:', error);\n      return [];\n    }\n  }\n\n  /**\n   * 독서 모임 가입\n   */\n  async joinReadingGroup(groupId: string, userId: string): Promise<boolean> {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups/${groupId}/join`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ userId, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n      \n      // 현재는 더미 응답 반환\n      console.log(`독서 모임 가입 요청: 모임 ${groupId}, 사용자 ${userId}`);\n      return true;\n    } catch (error) {\n      console.error('독서 모임 가입 실패:', error);\n      return false;\n    }\n  }\n\n  /**\n   * 독서 모임 생성\n   */\n  async createReadingGroup(groupData: any): Promise<boolean> {\n    try {\n      // 실제 구현 시:\n      // const response = await fetch(`${this.config.baseURL}/reading-groups`, {\n      //   method: 'POST',\n      //   headers: { 'Content-Type': 'application/json' },\n      //   body: JSON.stringify({ ...groupData, apiKey: this.config.apiKey })\n      // });\n      // return response.ok;\n      \n      // 현재는 더미 응답 반환\n      console.log('독서 모임 생성 요청:', groupData);\n      return true;\n    } catch (error) {\n      console.error('독서 모임 생성 실패:', error);\n      return false;\n    }\n  }\n}\n\n// 기본 API 설정 (환경변수에서 로드)\nexport const defaultLibraryAPI = new LibraryAPIService({\n  baseURL: process.env.REACT_APP_GYEONGGI_API_URL || 'https://openapi.gg.go.kr',\n      apiKey: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d'\n});\n\n// API 키 설정 가이드\nexport const API_SETUP_GUIDE = {\n  title: '경기도 공공데이터 API 연동 가이드',\n  steps: [\n    {\n      step: 1,\n      title: '경기데이터드림 회원가입',\n      description: 'https://data.gg.go.kr 에서 회원가입',\n      url: 'https://data.gg.go.kr'\n    },\n    {\n      step: 2,\n      title: 'API 키 발급',\n      description: '도서관 정보 API 서비스 신청 및 키 발급',\n      note: '승인까지 1-2일 소요'\n    },\n    {\n      step: 3,\n      title: '환경변수 설정',\n      description: '.env 파일에 API 키 추가',\n      code: `REACT_APP_GYEONGGI_API_URL=https://openapi.gg.go.kr\nREACT_APP_GYEONGGI_API_KEY=your_api_key_here\nREACT_APP_LIBRARY_API_KEY=your_library_api_key_here`\n    },\n    {\n      step: 4,\n      title: '도서관정보나루 연동',\n      description: 'data4library.kr에서 추가 도서 정보 API 활용',\n      url: 'https://www.data4library.kr'\n    }\n  ],\n  additionalAPIs: [\n    {\n      name: '경기데이터드림',\n      url: 'https://data.gg.go.kr',\n      description: '경기도 공공데이터 포털',\n      apis: [\n        '도서관 시설 정보',\n        '문화시설 현황',\n        '공공시설 위치 정보'\n      ]\n    },\n    {\n      name: '도서관정보나루',\n      url: 'https://www.data4library.kr',\n      description: '국가도서관통계시스템',\n      apis: [\n        '전국 도서관 정보',\n        '도서 검색',\n        '대출 통계'\n      ]\n    },\n    {\n      name: '각 시군 Open API',\n      description: '수원시, 성남시 등 각 지역별 API',\n      apis: [\n        '지역별 도서관 API',\n        '문화 프로그램 정보',\n        '시설 예약 시스템'\n      ]\n    }\n  ]\n};\n\n// 도서관 정보나루 API 서비스\nconst BASE_URL = 'http://data4library.kr/api';\n\n// API 인증키 (실제 인증키로 설정)\n// 도서관정보나루 API 키 설정됨\nconst AUTH_KEY = process.env.REACT_APP_LIBRARY_API_KEY || '651824a6d5a5d765b513f7f8059ef5ffb2ac3c30f15f0114a8764076c8b902b8';\n\n// API 승인 상태 확인 함수\nexport const checkApiApprovalStatus = async (apiKey: string): Promise<boolean> => {\n  try {\n    const response = await fetch(`https://www.data4library.kr/api/loanItemSrch?authKey=${apiKey}&startDt=2024-01-01&endDt=2024-01-31&pageNo=1&pageSize=1&format=json`);\n    const data = await response.json();\n    \n    // API 키가 승인되지 않은 경우 에러 응답을 받음\n    if (data.error || data.message?.includes('인증키') || data.message?.includes('승인')) {\n      return false;\n    }\n    \n    return true;\n  } catch (error) {\n    console.error('API 승인 상태 확인 중 오류:', error);\n    return false;\n  }\n};\n\n// 지역 코드 매핑 및 연령대 매핑 (필요 시 사용)\n\n// XML 응답을 파싱하는 함수\nconst parseXMLResponse = (xmlString: string): any => {\n  try {\n    // DOMParser를 사용하여 XML 파싱\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(xmlString, 'text/xml');\n    \n    // 파싱 오류 체크\n    const parseError = xmlDoc.getElementsByTagName('parsererror')[0];\n    if (parseError) {\n      console.error('XML 파싱 오류:', parseError.textContent);\n      return { response: { docs: [] } };\n    }\n    \n    // 인기대출도서 데이터 추출\n    const docs = xmlDoc.getElementsByTagName('doc');\n    const books: any[] = [];\n    \n    for (let i = 0; i < docs.length; i++) {\n      const doc = docs[i];\n      const book: any = {};\n      \n      // 각 필드 추출\n      const getTextContent = (tagName: string): string => {\n        const element = doc.getElementsByTagName(tagName)[0];\n        return element?.textContent || '';\n      };\n      \n      book.bookname = getTextContent('bookname');\n      book.authors = getTextContent('authors');\n      book.publisher = getTextContent('publisher');\n      book.publication_year = getTextContent('publication_year');\n      book.isbn13 = getTextContent('isbn13');\n      book.loan_count = parseInt(getTextContent('loan_count') || '0') || 0;\n      book.ranking = parseInt(getTextContent('ranking') || '0') || 0;\n      \n      if (book.bookname && book.bookname.trim() !== '') {\n        books.push(book);\n      }\n    }\n    \n    console.log(`📚 XML에서 추출된 도서 ${books.length}권:`, books);\n    \n    return {\n      response: {\n        docs: books,\n        numFound: books.length,\n        start: 0\n      }\n    };\n  } catch (error) {\n    console.error('XML 파싱 중 오류 발생:', error);\n    return { response: { docs: [] } };\n  }\n};\n\nexport interface PopularBookData {\n  id: string;\n  title: string;\n  author: string;\n  publisher: string;\n  isbn: string;\n  loanCount: number;\n  category: string;\n  publishYear: string;\n}\n\nexport interface ApiResponse {\n  response: {\n    docs: PopularBookData[];\n    numFound: number;\n    start: number;\n  };\n}\n\n/**\n * 인기 대출 도서 조회 API\n */\nexport const fetchPopularBooks = async (\n  startDate?: string,\n  endDate?: string\n): Promise<PopularBookData[]> => {\n  // 기본값: 실제 데이터가 있는 최근 기간 (2025년 데이터 사용)\n  const defaultEndDate = '2025-07-13';  // 2025년 7월 13일\n  const defaultStartDate = '2025-01-01'; // 2025년 시작\n  \n  const actualStartDate = startDate || defaultStartDate;\n  const actualEndDate = endDate || defaultEndDate;\n  try {\n    const params = new URLSearchParams({\n      authKey: process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY,\n      startDt: actualStartDate,\n      endDt: actualEndDate,\n      pageNo: '1',\n      pageSize: '20'\n    });\n\n    const url = `http://data4library.kr/api/loanItemSrch?${params}`;\n    \n    console.log(`🔥 인기대출도서 API 호출 (${actualStartDate} ~ ${actualEndDate}):`, url);\n    \n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      throw new Error(`API 호출 실패: ${response.status}`);\n    }\n    \n    const responseText = await response.text();\n    console.log('📊 인기도서 API 원본 응답:', responseText.substring(0, 500) + '...');\n    \n    let data;\n    try {\n      // JSON 파싱 시도\n      data = JSON.parse(responseText);\n    } catch (jsonError) {\n      // XML 응답인 경우 파싱\n      console.log('⚠️ JSON 파싱 실패, XML 응답 처리 중...');\n      data = parseXMLResponse(responseText);\n    }\n    \n    console.log('📊 인기도서 API 파싱된 데이터:', JSON.stringify(data, null, 2));\n    \n    // API 에러 체크\n    if (data.response && data.response.error) {\n      console.warn('API 에러:', data.response.error);\n      if (data.response.error.includes('활성화')) {\n        console.log('💡 API 키가 아직 활성화되지 않았습니다. 더미 데이터를 사용합니다.');\n      }\n      throw new Error(data.response.error);\n    }\n    \n    console.log('🔍 API 응답 구조 분석:');\n    console.log('- data.response:', data.response);\n    console.log('- data.response.docs:', data.response?.docs);\n    console.log('- docs 길이:', data.response?.docs?.length);\n    \n    // API 응답 데이터 구조에 맞게 변환\n    let rawBooks = [];\n    if (data.response && data.response.docs) {\n      rawBooks = data.response.docs;\n    } else if (data.response && data.response.result) {\n      rawBooks = data.response.result.docs || [];\n    } else if (Array.isArray(data.response)) {\n      rawBooks = data.response;\n    }\n    \n    console.log('📚 원본 도서 데이터:', rawBooks);\n    \n    const books: PopularBookData[] = rawBooks\n      ?.filter((book: any) => {\n        console.log('📖 개별 도서 데이터:', book);\n        return book.bookname && book.bookname.trim() !== '';\n      })\n      .map((book: any, index: number) => ({\n        id: book.isbn || `book_${index}`,\n        title: book.bookname.trim(), // 제목 공백 제거\n        author: book.authors || '작가 미상',\n        publisher: book.publisher || '출판사 미상',\n        isbn: book.isbn || '',\n        loanCount: parseInt(book.loan_count) || (index + 1) * 1000, // 대출수가 없으면 순위 기반으로 추정\n        category: book.class_nm || '일반',\n        publishYear: book.publication_year || '2023'\n      })) || [];\n    \n    console.log(`🏆 인기도서 ${books.length}권 조회 완료:`, books);\n    return books;\n    \n  } catch (error) {\n    console.error('❌ 인기도서 API 호출 오류:', error);\n    \n    // API 호출 실패시 더미 데이터 반환\n    return getFallbackPopularBooks();\n  }\n};\n\n/**\n * API 호출 실패시 사용할 더미 데이터\n */\n// 성인 대상 인기 도서 Top 5 (아동 도서 제외, 최신순)\nconst getFallbackPopularBooks = (): PopularBookData[] => {\n  console.log('📚 Fallback 인기도서 데이터 사용 (다양한 장르 포함)');\n  \n  return [\n    {\n      id: '1',\n      title: '어린왕자',\n      author: '생텍쥐페리',\n      publisher: '열린책들',\n      isbn: '9788932917245',\n      loanCount: 6890,\n      category: '문학',\n      publishYear: '2015'\n    },\n    {\n      id: '2',\n      title: '해리포터와 마법사의 돌',\n      author: 'J.K. 롤링',\n      publisher: '문학수첩',\n      isbn: '9788983920003',\n      loanCount: 6234,\n      category: '판타지',\n      publishYear: '2014'\n    },\n    {\n      id: '3',\n      title: '2030 자산관리 고민백서',\n      author: '오건영',\n      publisher: '비즈니스북스',\n      isbn: '9791162542439',\n      loanCount: 5420,\n      category: '경제',\n      publishYear: '2023'\n    },\n    {\n      id: '4',\n      title: '트렌드 코리아 2024',\n      author: '김난도',\n      publisher: '미래의창',\n      isbn: '9788959897264',\n      loanCount: 4890,\n      category: '사회',\n      publishYear: '2023'\n    },\n    {\n      id: '5',\n      title: '세이노의 가르침',\n      author: '세이노',\n      publisher: '데이원',\n      isbn: '9791191043297',\n      loanCount: 4321,\n      category: '자기계발',\n      publishYear: '2023'\n    },\n    {\n      id: '6',\n      title: '불편한 편의점',\n      author: '김호연',\n      publisher: '나무옆의자',\n      isbn: '9791167370778',\n      loanCount: 4156,\n      category: '소설',\n      publishYear: '2021'\n    },\n    {\n      id: '7',\n      title: '달러구트 꿈 백화점',\n      author: '이미예',\n      publisher: '팩토리나인',\n      isbn: '9791165340564',\n      loanCount: 3987,\n      category: '소설',\n      publishYear: '2020'\n    },\n    {\n      id: '8',\n      title: '82년생 김지영',\n      author: '조남주',\n      publisher: '민음사',\n      isbn: '9788937473142',\n      loanCount: 3765,\n      category: '소설',\n      publishYear: '2016'\n    },\n    {\n      id: '9',\n      title: '미드나잇 라이브러리',\n      author: '매트 헤이그',\n      publisher: '인플루엔셜',\n      isbn: '9788960516618',\n      loanCount: 3542,\n      category: '소설',\n      publishYear: '2021'\n    },\n    {\n      id: '10',\n      title: '소년이 온다',\n      author: '한강',\n      publisher: '창비',\n      isbn: '9788936434120',\n      loanCount: 3298,\n      category: '소설',\n      publishYear: '2014'\n    }\n  ];\n};\n\n/**\n * 도서 검색 API 함수 (외부에서 직접 호출용)\n */\nexport const searchBooksAPI = async (\n  query: string,\n  pageNo: number = 1,\n  pageSize: number = 10\n): Promise<BookSearchResult[]> => {\n  const apiService = new LibraryAPIService({\n    baseURL: BASE_URL,\n    apiKey: AUTH_KEY\n  });\n  \n  return await apiService.searchBooks({\n    query,\n    pageNo,\n    pageSize\n  });\n};\n\n/**\n * API 연결 상태 테스트\n */\nexport const testApiConnection = async (): Promise<{\n  success: boolean;\n  message: string;\n  details?: any;\n}> => {\n  try {\n    console.log('🔄 API 연결 테스트 시작...');\n    \n    // 1. 도서관정보나루 API 테스트\n    const testQuery = '해리포터';\n    const searchUrl = `${BASE_URL}/srchBooks`;\n    const params = new URLSearchParams({\n      authKey: AUTH_KEY,\n      format: 'json',\n      pageNo: '1',\n      pageSize: '5',\n      keyword: testQuery\n    });\n\n    const libraryResponse = await fetch(`${searchUrl}?${params}`);\n    const libraryData = await libraryResponse.json();\n\n    // 2. 경기데이터드림 API 테스트 (여러 시도)\n    const gyeonggiApiKey = process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d';\n    let gyeonggiResponse: Response;\n    let gyeonggiData: any;\n    \n    // 첫 번째 시도: 올바른 엔드포인트 사용\n    try {\n      const gyeonggiUrl1 = `https://openapi.gg.go.kr/TBGGIBLLBR`;\n      const gyeonggiParams1 = new URLSearchParams({\n        KEY: gyeonggiApiKey,\n        Type: 'json',\n        pIndex: '1',\n        pSize: '10'\n      });\n      \n      gyeonggiResponse = await fetch(`${gyeonggiUrl1}?${gyeonggiParams1}`);\n      gyeonggiData = await gyeonggiResponse.json();\n      \n      if (!gyeonggiResponse.ok) {\n        throw new Error('First attempt failed');\n      }\n    } catch (error) {\n      // 두 번째 시도: 다른 매개변수 형식\n      try {\n        const gyeonggiUrl2 = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${gyeonggiApiKey}&Type=json&pIndex=1&pSize=10`;\n        gyeonggiResponse = await fetch(gyeonggiUrl2);\n        gyeonggiData = await gyeonggiResponse.json();\n        \n        if (!gyeonggiResponse.ok) {\n          throw new Error('Second attempt failed');\n        }\n      } catch (error2) {\n        // 세 번째 시도: 기본 매개변수만 사용\n        try {\n          const gyeonggiUrl3 = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${gyeonggiApiKey}`;\n          gyeonggiResponse = await fetch(gyeonggiUrl3);\n          gyeonggiData = await gyeonggiResponse.json();\n          \n          if (!gyeonggiResponse.ok) {\n            throw new Error('Third attempt failed');\n          }\n        } catch (error3) {\n          // 모든 시도 실패 시 기본값\n          gyeonggiResponse = { ok: false } as Response;\n          gyeonggiData = { error: 'All attempts failed' };\n        }\n      }\n    }\n\n    const libraryApiSuccess = libraryResponse.ok && libraryData.response && libraryData.response.docs;\n    const gyeonggiApiSuccess = gyeonggiResponse.ok && gyeonggiData.TBGGIBLLBR && gyeonggiData.TBGGIBLLBR[1];\n\n    if (libraryApiSuccess && gyeonggiApiSuccess) {\n      console.log('✅ 도서관정보나루 API 연결 성공');\n      console.log('✅ 경기데이터드림 API 연결 성공');\n      return {\n        success: true,\n        message: '모든 API 연결 성공! 실제 도서관 데이터를 사용합니다.',\n        details: {\n          libraryBooks: libraryData.response.numFound,\n          gyeonggiLibraries: gyeonggiData.TBGGIBLLBR[1].row?.length || 0,\n          sampleBooks: libraryData.response.docs.slice(0, 3)\n        }\n      };\n    } else if (libraryApiSuccess) {\n      console.log('✅ 도서관정보나루 API 연결 성공');\n      console.log('❌ 경기데이터드림 API 연결 실패');\n      return {\n        success: true,\n        message: '도서관정보나루 API만 연결됨. 도서 검색은 가능하지만 일부 기능이 제한됩니다.',\n        details: {\n          libraryBooks: libraryData.response.numFound,\n          gyeonggiLibraries: 0,\n          sampleBooks: libraryData.response.docs.slice(0, 3)\n        }\n      };\n    } else {\n      console.log('❌ 도서관정보나루 API 연결 실패');\n      console.log('❌ 경기데이터드림 API 연결 실패');\n      \n      // 각 API의 실패 원인을 자세히 분석\n      const failureAnalysis = {\n        libraryApi: {\n          status: libraryResponse.status,\n          statusText: libraryResponse.statusText,\n          data: libraryData\n        },\n        gyeonggiApi: {\n          status: gyeonggiResponse.ok ? 'ok' : 'failed',\n          data: gyeonggiData,\n          error: gyeonggiData?.error || 'Unknown error'\n        }\n      };\n      \n      return {\n        success: false,\n        message: 'API 연결 실패. 브라우저에서 CORS 제한이나 API 키 문제일 수 있습니다.',\n        details: failureAnalysis\n      };\n    }\n  } catch (error) {\n    console.error('API 연결 테스트 오류:', error);\n    return {\n      success: false,\n      message: 'API 연결 오류. 네트워크를 확인하거나 더미 데이터를 사용합니다.',\n      details: error\n    };\n  }\n};\n\n/**\n * 경기데이터드림 API CORS 우회 테스트\n */\nexport const testGyeonggiApiWithProxy = async (apiKey: string = '8b62aa70e514468596e9324d064d582d'): Promise<{\n  success: boolean;\n  message: string;\n  details?: any;\n}> => {\n  try {\n    // 올바른 엔드포인트 사용\n    const methods = [\n      // 1. 올바른 엔드포인트 직접 호출\n      {\n        name: 'Correct Endpoint',\n        url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}&Type=json&pIndex=1&pSize=5`\n      },\n      // 2. 추가 매개변수 포함\n      {\n        name: 'With Additional Params',\n        url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}&Type=json&pIndex=1&pSize=10`\n      },\n      // 3. 매개변수 순서 변경\n      {\n        name: 'Parameter Order Change',\n        url: `https://openapi.gg.go.kr/TBGGIBLLBR?Type=json&KEY=${apiKey}&pIndex=1&pSize=5`\n      },\n      // 4. 파라미터 없이 기본 호출\n      {\n        name: 'Basic Call',\n        url: `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}`\n      }\n    ];\n\n    for (const method of methods) {\n      try {\n        console.log(`🔄 ${method.name} 시도:`, method.url);\n        \n        const response = await fetch(method.url, {\n          method: 'GET',\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          },\n          mode: 'cors'\n        });\n\n        console.log(`📊 ${method.name} 응답:`, response.status, response.statusText);\n        \n        if (response.ok) {\n          const data = await response.json();\n          console.log(`✅ ${method.name} 성공:`, data);\n          \n          return {\n            success: true,\n            message: `경기데이터드림 API 연결 성공 (${method.name})`,\n            details: {\n              method: method.name,\n              url: method.url,\n              data: data\n            }\n          };\n        } else {\n          const errorText = await response.text();\n          console.log(`❌ ${method.name} 실패:`, errorText);\n        }\n      } catch (error) {\n        console.log(`❌ ${method.name} 오류:`, error);\n      }\n    }\n\n    return {\n      success: false,\n      message: '모든 경기데이터드림 API 연결 방법 실패. CORS 문제이거나 API 키가 유효하지 않을 수 있습니다.',\n      details: {\n        attempted_methods: methods.map(m => m.name),\n        suggestion: 'API 키가 활성화될 때까지 기다리거나, 서버사이드에서 API를 호출하는 것을 고려해보세요.'\n      }\n    };\n\n  } catch (error) {\n    return {\n      success: false,\n      message: '경기데이터드림 API 테스트 중 오류 발생',\n      details: error\n    };\n  }\n};\n\n/**\n * API 연결 문제 해결 가이드\n */\nexport const getApiTroubleshootingGuide = (): string[] => {\n  return [\n    '🔧 API 연결 문제 해결 방법:',\n    '',\n    '1. API 키 확인:',\n    '   - 도서관정보나루: 651824a6d5a5d765b513f7f8059ef5ffb2ac3c30f15f0114a8764076c8b902b8',\n    '   - 경기데이터드림: 8b62aa70e514468596e9324d064d582d',\n    '',\n    '2. API 키 활성화 상태:',\n    '   - 신청 후 1-2시간 정도 소요될 수 있습니다',\n    '   - 각 사이트에서 승인 상태를 확인해보세요',\n    '',\n    '3. CORS 문제 (브라우저 보안 정책):',\n    '   - 브라우저에서 직접 호출 시 발생할 수 있습니다',\n    '   - 개발 중에는 더미 데이터를 사용합니다',\n    '   - 배포 시에는 서버사이드에서 API를 호출하세요',\n    '',\n    '4. 네트워크 문제:',\n    '   - 인터넷 연결을 확인해보세요',\n    '   - 방화벽이나 프록시 설정을 확인해보세요',\n    '',\n    '5. 현재 상태:',\n    '   - 도서관정보나루 API: 정상 작동 중',\n    '   - 경기데이터드림 API: 연결 문제 (CORS 또는 API 키)',\n    '',\n    '📞 문의처:',\n    '   - 도서관정보나루: http://data4library.kr',\n    '   - 경기데이터드림: https://data.gg.go.kr'\n  ];\n};\n\n/**\n * 현재 API 설정 정보 확인\n */\nexport const getApiStatus = (): {\n  configured: boolean;\n  apiKey: string;\n  message: string;\n} => {\n  const hasApiKey = Boolean(AUTH_KEY && AUTH_KEY !== 'your_actual_api_key_here' && AUTH_KEY.length > 10);\n  const isFromEnv = process.env.REACT_APP_LIBRARY_API_KEY !== undefined;\n  \n  return {\n    configured: hasApiKey,\n    apiKey: AUTH_KEY ? `${AUTH_KEY.substring(0, 10)}...` : 'Not set',\n    message: hasApiKey \n      ? `API 키 설정됨 (${isFromEnv ? '환경변수' : '코드'})`\n      : 'API 키를 설정해주세요'\n  };\n};\n\n/**\n * 환경 설정 확인\n */\nexport const checkApiConfiguration = (): boolean => {\n  if (!AUTH_KEY || AUTH_KEY.length < 10) {\n    console.warn('⚠️ API 인증키가 설정되지 않았습니다. 더미 데이터를 사용합니다.');\n    return false;\n  }\n  console.log('✅ API 인증키가 설정되었습니다.');\n  return true;\n};\n\n/**\n * 실제 API 사용 예시\n */\nexport const exampleApiUsage = async () => {\n  try {\n    // 도서 검색 예시\n    console.log('=== 도서 검색 API 테스트 ===');\n    const searchResults = await searchBooksAPI('사피엔스', 1, 5);\n    console.log('검색 결과:', searchResults);\n    \n    // 인기 도서 조회 예시\n    console.log('=== 인기 도서 API 테스트 ===');\n    const popularBooks = await fetchPopularBooks();\n    console.log('인기도서 목록:', popularBooks);\n    \n    return { searchResults, popularBooks };\n  } catch (error) {\n    console.error('API 사용 예시 오류:', error);\n    return { searchResults: [], popularBooks: [] };\n  }\n}; \n\n/**\n * 브라우저에서 API 테스트를 위한 전역 함수\n */\nif (typeof window !== 'undefined') {\n  (window as any).testLibraryAPI = async () => {\n    console.log('🔍 도서관 API 테스트 시작...');\n    \n    // 1. API 설정 상태 확인\n    const apiStatus = getApiStatus();\n    console.log('📊 API 설정 상태:', apiStatus);\n    \n    // 2. API 연결 테스트\n    try {\n      const connectionTest = await testApiConnection();\n      console.log('🔗 API 연결 테스트 결과:', connectionTest);\n      \n      if (connectionTest.success) {\n        console.log('✅ 성공! 실제 도서관 데이터 사용 가능');\n        console.log('📚 도서 검색 결과:', connectionTest.details?.libraryBooks, '권');\n        console.log('🏛️ 경기도 도서관 수:', connectionTest.details?.gyeonggiLibraries, '개');\n        console.log('📖 샘플 도서 데이터:', connectionTest.details?.sampleBooks);\n      } else {\n        console.log('❌ 실패:', connectionTest.message);\n      }\n      \n      return connectionTest;\n    } catch (error) {\n      console.error('🚨 API 테스트 오류:', error);\n      return { success: false, message: 'API 테스트 실행 오류', details: error };\n    }\n  };\n  \n  (window as any).searchLibraryBooks = async (query: string = '해리포터') => {\n    console.log(`🔍 도서 검색 테스트: \"${query}\"`);\n    \n    try {\n      const results = await searchBooksAPI(query, 1, 5);\n      console.log('📚 검색 결과:', results);\n      \n      if (results && results.length > 0) {\n        console.log(`✅ ${results.length}권의 도서를 찾았습니다!`);\n        results.forEach((book, index) => {\n          console.log(`${index + 1}. ${book.title} - ${book.author} (${book.publisher})`);\n        });\n      } else {\n        console.log('❌ 검색 결과가 없습니다.');\n      }\n      \n      return results;\n    } catch (error) {\n      console.error('🚨 도서 검색 오류:', error);\n      return [];\n    }\n  };\n  \n  (window as any).testGyeonggiAPI = async () => {\n    console.log('🔍 경기데이터드림 API 단독 테스트...');\n    return await testGyeonggiApiWithProxy();\n  };\n  \n  (window as any).showApiGuide = () => {\n    console.log('📖 API 문제 해결 가이드:');\n    const guide = getApiTroubleshootingGuide();\n    guide.forEach(line => console.log(line));\n    return guide;\n  };\n} \n\n/**\n * 전체 API 시스템 종합 테스트\n */\nif (typeof window !== 'undefined') {\n  (window as any).testAllLibraryAPIs = async () => {\n    console.log('🔥 === 도서관 API 종합 테스트 시작 === 🔥');\n    \n    try {\n      // 1. 기본 API 연결 테스트\n      console.log('\\n1️⃣ 기본 API 연결 테스트...');\n      const connectionTest = await testApiConnection();\n      console.log('결과:', connectionTest);\n      \n      // 2. 도서 검색 테스트\n      console.log('\\n2️⃣ 도서 검색 테스트...');\n      const searchResults = await searchBooksAPI('해리포터', 1, 5);\n      console.log('검색 결과:', searchResults);\n      \n      // 3. 인기 도서 조회 테스트\n      console.log('\\n3️⃣ 인기 도서 조회 테스트...');\n              const popularBooks = await fetchPopularBooks();\n      console.log('인기 도서:', popularBooks);\n      \n      // 4. 경기도 도서관 정보 테스트\n      console.log('\\n4️⃣ 경기도 도서관 정보 테스트...');\n      const libraryAPI = new LibraryAPIService({\n        baseURL: 'https://openapi.gg.go.kr',\n        apiKey: process.env.REACT_APP_GYEONGGI_API_KEY || '8b62aa70e514468596e9324d064d582d'\n      });\n      \n      const libraries = await libraryAPI.getLibraries();\n      console.log('경기도 도서관 목록:', libraries.length, '개');\n      console.log('샘플 도서관:', libraries.slice(0, 3));\n      \n      // 5. 종합 결과\n      console.log('\\n🎯 === 종합 테스트 결과 === 🎯');\n      console.log('✅ API 연결 상태:', connectionTest.success ? '성공' : '실패');\n      console.log('📚 검색 가능 도서 수:', searchResults.length, '권');\n      console.log('🔥 인기 도서 수:', popularBooks.length, '권');\n      console.log('🏛️ 경기도 도서관 수:', libraries.length, '개');\n      \n      if (connectionTest.success && searchResults.length > 0) {\n        console.log('🎉 모든 API가 정상 작동하고 있습니다!');\n      } else {\n        console.log('⚠️ 일부 API에 문제가 있습니다. 더미 데이터를 사용합니다.');\n      }\n      \n      return {\n        connectionTest,\n        searchResults,\n        popularBooks,\n        libraries: libraries.length\n      };\n      \n    } catch (error) {\n      console.error('🚨 종합 테스트 오류:', error);\n      return null;\n    }\n  };\n} \n\n/**\n * 브라우저 콘솔에서 직접 테스트할 수 있는 함수\n * 사용법: testCorrectGyeonggiAPI()\n */\nexport const testCorrectGyeonggiAPI = async (): Promise<void> => {\n  console.log('🔍 올바른 경기데이터드림 API 엔드포인트 테스트 시작...');\n  \n  const apiKey = '8b62aa70e514468596e9324d064d582d';\n  const correctUrl = `https://openapi.gg.go.kr/TBGGIBLLBR?KEY=${apiKey}`;\n  \n  try {\n    console.log('📞 API 호출:', correctUrl);\n    const response = await fetch(correctUrl);\n    \n    console.log('📊 응답 상태:', response.status, response.statusText);\n    \n    if (response.ok) {\n      const data = await response.json();\n      console.log('✅ API 연결 성공!');\n      console.log('📋 응답 데이터:', data);\n      \n      if (data.TBGGIBLLBR && data.TBGGIBLLBR[1] && data.TBGGIBLLBR[1].row) {\n        console.log('📚 도서관 개수:', data.TBGGIBLLBR[1].row.length);\n        console.log('📍 첫 번째 도서관:', data.TBGGIBLLBR[1].row[0]);\n      }\n    } else {\n      console.log('❌ API 호출 실패:', response.status, response.statusText);\n    }\n  } catch (error) {\n    console.log('🚨 오류 발생:', error);\n  }\n};\n\n// 도서관정보나루 API 직접 테스트\nexport const testLibraryAPI = async (): Promise<void> => {\n  const apiKey = process.env.REACT_APP_LIBRARY_API_KEY || AUTH_KEY;\n  \n  console.log('🔑 사용 중인 API 키:', `${apiKey.substring(0, 10)}...`);\n  \n  // 1. 간단한 도서관 조회 API 테스트\n  const libTestUrl = `http://data4library.kr/api/libSrch?authKey=${apiKey}&pageNo=1&pageSize=5`;\n  console.log('🏛️ 도서관 조회 API 테스트:', libTestUrl);\n  \n  try {\n    const response = await fetch(libTestUrl);\n    const data = await response.text(); // 먼저 text로 받아보기\n    \n    console.log('📄 도서관 조회 API 응답 (원본):', data);\n    \n    // XML 응답을 JSON으로 파싱 시도\n    try {\n      const jsonData = JSON.parse(data);\n      console.log('✅ JSON 파싱 성공:', jsonData);\n    } catch (parseError) {\n      console.log('⚠️ JSON 파싱 실패, XML 응답인 것 같습니다');\n    }\n  } catch (error) {\n    console.error('❌ 도서관 조회 API 테스트 실패:', error);\n  }\n  \n  // 2. 인기대출도서 API 테스트\n  const popularTestUrl = `http://data4library.kr/api/loanItemSrch?authKey=${apiKey}&startDt=2023-01-01&endDt=2023-12-31&pageNo=1&pageSize=5`;\n  console.log('🏆 인기대출도서 API 테스트:', popularTestUrl);\n  \n  try {\n    const response = await fetch(popularTestUrl);\n    const data = await response.text(); // 먼저 text로 받아보기\n    \n    console.log('📄 인기대출도서 API 응답 (원본):', data.substring(0, 500) + '...');\n    \n    // XML 응답을 JSON으로 파싱 시도\n    try {\n      const jsonData = JSON.parse(data);\n      console.log('✅ JSON 파싱 성공:', jsonData);\n    } catch (parseError) {\n      console.log('⚠️ JSON 파싱 실패, XML 응답 처리 중...');\n      const xmlData = parseXMLResponse(data);\n      console.log('✅ XML 파싱 성공:', xmlData);\n      console.log('📊 추출된 도서 수:', xmlData.response.docs.length);\n    }\n  } catch (error) {\n    console.error('❌ 인기대출도서 API 테스트 실패:', error);\n  }\n};\n\n// 전역 객체에 함수 추가 (브라우저 콘솔에서 쉽게 접근)\nif (typeof window !== 'undefined') {\n  (window as any).testCorrectGyeonggiAPI = testCorrectGyeonggiAPI;\n  (window as any).testLibraryAPI = testLibraryAPI;\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}